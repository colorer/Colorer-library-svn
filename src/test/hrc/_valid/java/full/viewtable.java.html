<html><body style='color:#000000; background:#ffffff; '><pre>
  0: 
  1: <span style='color:#800000; font-weight:bold; '>package</span><span style='color:#004a43; '> ru</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>grw</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>server</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>ssvt</span><span style='color:#800080; '>;</span>
  2: 
  3: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>sql</span><span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>*</span><span style='color:#800080; '>;</span>
  4: 
  5: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Enumeration</span><span style='color:#800080; '>;</span>
  6: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>GregorianCalendar</span><span style='color:#800080; '>;</span>
  7: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Hashtable</span><span style='color:#800080; '>;</span>
  8: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Vector</span><span style='color:#800080; '>;</span>
  9: 
 10: <span style='color:#696969; '>//import ru.grw.http.core.HttpUser;</span>
 11: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> ru</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>grw</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>server</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>http</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>HttpUser</span><span style='color:#800080; '>;</span>
 12: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> ru</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>grw</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>sql</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Field</span><span style='color:#800080; '>;</span>
 13: <span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> ru</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>grw</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Function</span><span style='color:#800080; '>;</span>
 14: 
 15: <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>class</span> ViewTable <span style='color:#800080; '>{</span>
 16: 
 17:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> tables <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 18: 
 19:     <span style='color:#800000; font-weight:bold; '>protected</span> <span style='color:#800000; font-weight:bold; '>static</span> TableQuery initFields<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 20:         <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"table"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 21:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 22:             TableQuery tableQuery <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>TableQuery<span style='color:#808030; '>)</span> tables<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 23:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>tableQuery <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 24:                 tableQuery <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> TableQuery<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 25:                 tables<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>,</span> tableQuery<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 26:                 <span style='color:#bb7977; font-weight:bold; '>String</span> startName <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"startName"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 27:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>startName <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> startName <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>""</span><span style='color:#800080; '>;</span>
 28:                 <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 29:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 30:                     <span style='color:#bb7977; font-weight:bold; '>String</span> sql <span style='color:#808030; '>=</span> getRecordsSQL<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> tableName<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 31:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
 32:                         <span style='color:#bb7977; font-weight:bold; '>PreparedStatement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>prepareStatement<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 33:                         <span style='color:#bb7977; font-weight:bold; '>ResultSet</span> result <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeQuery<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 34:                         <span style='color:#bb7977; font-weight:bold; '>ResultSetMetaData</span> meta <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getMetaData<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 35:                         <span style='color:#bb7977; '>int</span> columnCount <span style='color:#808030; '>=</span> meta<span style='color:#808030; '>.</span>getColumnCount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 36:                         <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span> index <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>=</span> columnCount<span style='color:#800080; '>;</span> index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 37:                             <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> meta<span style='color:#808030; '>.</span>getColumnName<span style='color:#808030; '>(</span>index<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 38:                             <span style='color:#bb7977; '>int</span> type <span style='color:#808030; '>=</span> meta<span style='color:#808030; '>.</span>getColumnType<span style='color:#808030; '>(</span>index<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 39:                             <span style='color:#bb7977; '>int</span> size <span style='color:#808030; '>=</span> meta<span style='color:#808030; '>.</span>getColumnDisplaySize<span style='color:#808030; '>(</span>index<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 40:                             tableQuery<span style='color:#808030; '>.</span>addField<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>(</span>name<span style='color:#808030; '>,</span> type<span style='color:#808030; '>,</span> size<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 41:                         <span style='color:#800080; '>}</span>
 42:                         result<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 43:                         statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 44:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 45:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 46:                     <span style='color:#800080; '>}</span>
 47:                     <span style='color:#696969; '>// получить список прав пользователей на таблицу</span>
 48:                     <span style='color:#bb7977; font-weight:bold; '>String</span> sqlRights <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"getSqlRights"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 49:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
 50:                         <span style='color:#bb7977; font-weight:bold; '>PreparedStatement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>prepareStatement<span style='color:#808030; '>(</span>sqlRights<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 51:                         statement<span style='color:#808030; '>.</span>setString<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> tableName<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 52:                         <span style='color:#bb7977; font-weight:bold; '>ResultSet</span> result <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeQuery<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 53:                         <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span>result<span style='color:#808030; '>.</span>next<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 54:                             <span style='color:#bb7977; font-weight:bold; '>String</span> userName <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_USER"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 55:                             <span style='color:#bb7977; font-weight:bold; '>String</span> table <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_TABLE"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 56:                             <span style='color:#bb7977; font-weight:bold; '>String</span> rightSelect <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_SELECT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 57:                             <span style='color:#bb7977; font-weight:bold; '>String</span> rightUpdate <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_UPDATE"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 58:                             <span style='color:#bb7977; font-weight:bold; '>String</span> rightInsert <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_INSERT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 59:                             <span style='color:#bb7977; font-weight:bold; '>String</span> rightDelete <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"AD_DELETE"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 60:                             TableUser tableUser <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> TableUser<span style='color:#808030; '>(</span>userName<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Y"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>rightSelect<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Y"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>rightUpdate<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Y"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>rightInsert<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Y"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>rightDelete<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 61:                             tableQuery<span style='color:#808030; '>.</span>addUser<span style='color:#808030; '>(</span>tableUser<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 62:                         <span style='color:#800080; '>}</span>
 63:                         result<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 64:                         statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 65:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 66:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 67:                     <span style='color:#800080; '>}</span>
 68:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
 69:                         connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 70:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 71:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 72:                     <span style='color:#800080; '>}</span>
 73:                     <span style='color:#bb7977; font-weight:bold; '>String</span> keyField<span style='color:#800080; '>;</span>
 74:                     <span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
 75:                     <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>keyField <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>".key."</span> <span style='color:#808030; '>+</span> index<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 76:                          tableQuery<span style='color:#808030; '>.</span>addKey<span style='color:#808030; '>(</span>keyField<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 77:                          index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
 78:                     <span style='color:#800080; '>}</span>
 79:                     <span style='color:#bb7977; font-weight:bold; '>String</span> hiddenField<span style='color:#800080; '>;</span>
 80:                     index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
 81:                     <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>hiddenField <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>".hidden."</span> <span style='color:#808030; '>+</span> index<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 82:                          tableQuery<span style='color:#808030; '>.</span>addHidden<span style='color:#808030; '>(</span>hiddenField<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 83:                          index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
 84:                     <span style='color:#800080; '>}</span>
 85:                 <span style='color:#800080; '>}</span>
 86:             <span style='color:#800080; '>}</span>
 87:             <span style='color:#800000; font-weight:bold; '>return</span> tableQuery<span style='color:#800080; '>;</span>
 88:         <span style='color:#800080; '>}</span>
 89:         <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#800080; '>;</span>
 90:     <span style='color:#800080; '>}</span>
 91: 
 92:     <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> getForm<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 93:         <span style='color:#bb7977; font-weight:bold; '>String</span> action <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"action"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 94:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>action <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span> getRecords<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 95:         <span style='color:#800000; font-weight:bold; '>return</span> getFormRecord<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
 96:     <span style='color:#800080; '>}</span>
 97: 
 98:     <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> handlePost<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
 99:         <span style='color:#bb7977; font-weight:bold; '>String</span> action <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"action"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
100:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>action <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#800080; '>;</span>
101:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>action<span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"add"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span> insertRecord<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
102:         <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800000; font-weight:bold; '>return</span> updateRecord<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
103:     <span style='color:#800080; '>}</span>
104: 
105:     <span style='color:#800000; font-weight:bold; '>protected</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>String</span> getRecordsSQL<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>String</span> tableName<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
106:         <span style='color:#bb7977; font-weight:bold; '>String</span> sql <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"getRecords"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
107:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>sql <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> sql <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"select * from "</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"schema"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> tableName<span style='color:#800080; '>;</span>
108:         <span style='color:#800000; font-weight:bold; '>return</span> sql<span style='color:#800080; '>;</span>
109:     <span style='color:#800080; '>}</span>
110: 
111:     <span style='color:#800000; font-weight:bold; '>protected</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; '>boolean</span> insertLinksToHTML<span style='color:#808030; '>(</span>HttpUser user<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
112:         <span style='color:#bb7977; '>boolean</span> insertLinks<span style='color:#800080; '>;</span>
113:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>user <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
114:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>isAdministrator<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> <span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
115:                 insertLinks <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
116:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
117:                 insertLinks <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
118:             <span style='color:#800080; '>}</span>
119:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
120:             insertLinks <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
121:         <span style='color:#800080; '>}</span>
122:         <span style='color:#800000; font-weight:bold; '>return</span> insertLinks<span style='color:#800080; '>;</span>
123:     <span style='color:#800080; '>}</span>
124: 
125:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> insertRecord<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
126:         attributes<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"nocache"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"yes"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
127:         TableQuery tableQuery <span style='color:#808030; '>=</span> initFields<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
128:         <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
129:         <span style='color:#bb7977; font-weight:bold; '>String</span> resultMessage<span style='color:#800080; '>;</span>
130:         <span style='color:#bb7977; '>boolean</span> execute <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>false</span><span style='color:#800080; '>;</span>
131: 
132:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>isAdministrator<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> tableQuery<span style='color:#808030; '>.</span>getUser<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getInsert<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
133:             <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
134:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
135:                 <span style='color:#696969; '>// Сформировать SQL запрос</span>
136:                 <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"insert into "</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"schema"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'.'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" ("</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
137:                 <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> values <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"("</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
138:                 <span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
139:                 <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> enumeration <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getSequence<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> enumeration<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
140:                     <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> enumeration<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
141:                     <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
142:                     <span style='color:#bb7977; font-weight:bold; '>String</span> value <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> 
143:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
144:                         <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
145:                             value <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> user<span style='color:#808030; '>.</span>getAttribute<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
146:                         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
147:                         <span style='color:#800080; '>}</span>
148:                     <span style='color:#800080; '>}</span>
149:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
150:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
151:                             sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>", "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
152:                             values<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>", "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
153:                         <span style='color:#800080; '>}</span>
154:                         sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
155:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> values<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"NULL"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
156:                         <span style='color:#800000; font-weight:bold; '>else</span> values<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> value<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
157:                         index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
158:                     <span style='color:#800080; '>}</span>
159:                 <span style='color:#800080; '>}</span>
160:                 sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>") values "</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>values<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>")"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
161:                 ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>": "</span> <span style='color:#808030; '>+</span> sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
162:                 <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
163:                     <span style='color:#bb7977; font-weight:bold; '>Statement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>createStatement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
164:                     statement<span style='color:#808030; '>.</span>execute<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
165:                     statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
166:                     resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.insertOk"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
167:                     execute <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
168:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
169:                     resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.executeError"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> e<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
170:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
171:                 <span style='color:#800080; '>}</span>
172:                 <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
173:                     connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
174:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
175:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
176:                 <span style='color:#800080; '>}</span>
177:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
178:                 resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.connectError"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
179:             <span style='color:#800080; '>}</span>
180:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
181:             resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.notRights"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
182:         <span style='color:#800080; '>}</span>
183: 
184:         <span style='color:#bb7977; font-weight:bold; '>String</span> title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecordTitle"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
185:         <span style='color:#800000; font-weight:bold; '>return</span> getHtmlResultPage<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> tableQuery<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>,</span> title<span style='color:#808030; '>,</span> resultMessage<span style='color:#808030; '>,</span> execute<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
186:     <span style='color:#800080; '>}</span>
187: 
188: 
189:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> updateRecord<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
190:         attributes<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"nocache"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"yes"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
191:         TableQuery tableQuery <span style='color:#808030; '>=</span> initFields<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
192:         <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
193:         <span style='color:#696969; '>// Получить вектор ключевых полей</span>
194:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> keys <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getKeys<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
195:         <span style='color:#bb7977; '>boolean</span> execute <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>false</span><span style='color:#800080; '>;</span>
196:         <span style='color:#bb7977; font-weight:bold; '>String</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>""</span><span style='color:#800080; '>;</span>
197:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"delRecord"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
198:             <span style='color:#696969; '>// Выполнить UPDATE записи</span>
199:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>isAdministrator<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> tableQuery<span style='color:#808030; '>.</span>getUser<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getUpdate<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
200:                 <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
201:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
202:                     <span style='color:#696969; '>// Сформировать SQL запрос</span>
203:                     <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"update "</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"schema"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'.'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" set "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
204:                     <span style='color:#696969; '>// Установить значения изменяемых полей</span>
205:                     <span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
206:                     <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getSequence<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
207:                         <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
208:                         <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
209:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>keys<span style='color:#808030; '>.</span>contains<span style='color:#808030; '>(</span>field<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
210:                             <span style='color:#bb7977; font-weight:bold; '>String</span> value <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
211:                             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
212:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>", "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
213:                                 sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'='</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
214:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"NULL"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
215:                                 <span style='color:#800000; font-weight:bold; '>else</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> value<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
216:                                 index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
217:                             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
218: <span style='color:#696969; '>//</span>
219:                                 <span style='color:#bb7977; font-weight:bold; '>String</span> keyField <span style='color:#808030; '>=</span> tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"FORM"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> name<span style='color:#800080; '>;</span>
220:                                 <span style='color:#bb7977; font-weight:bold; '>String</span> objectName <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"INPUT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
221:                                 <span style='color:#bb7977; font-weight:bold; '>String</span> type <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"TYPE"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"TEXT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
222:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#0000e6; '>"CHECKBOX"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>type<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> objectName<span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"INPUT"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
223:                                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>", "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
224:                                     sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'='</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
225:                                     <span style='color:#bb7977; font-weight:bold; '>String</span> defaultValue <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"FORM"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"CHECKBOX"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"DEFAULT"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"NO"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
226:                                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#0000e6; '>"NULL"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>defaultValue<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"null"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
227:                                     <span style='color:#800000; font-weight:bold; '>else</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> defaultValue<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
228:                                     index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
229:                                 <span style='color:#800080; '>}</span> 
230: <span style='color:#696969; '>//</span>
231:                             <span style='color:#800080; '>}</span>
232:                         <span style='color:#800080; '>}</span>
233:                     <span style='color:#800080; '>}</span>
234:                     <span style='color:#696969; '>// Установить значения уникальных полей</span>
235:                     sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" where "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
236:                     addKeyFieldsToSQL<span style='color:#808030; '>(</span>keys<span style='color:#808030; '>,</span> sql<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
237:                     <span style='color:#696969; '>// Выполнить сформированный запрос</span>
238:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>": "</span> <span style='color:#808030; '>+</span> sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
239:                     <span style='color:#bb7977; '>int</span> updateRecords <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
240:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
241:                         <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
242:                             <span style='color:#bb7977; font-weight:bold; '>Statement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>createStatement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
243:                             updateRecords <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeUpdate<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
244:                             statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
245:                             <span style='color:#800000; font-weight:bold; '>switch</span> <span style='color:#808030; '>(</span>updateRecords<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
246:                                 <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Запись не изменена."</span><span style='color:#800080; '>;</span>
247:                                         <span style='color:#800000; font-weight:bold; '>break</span><span style='color:#800080; '>;</span>
248:                                 <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Операция редактирования записи выполнена успешно."</span><span style='color:#800080; '>;</span>
249:                                         execute <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
250:                                         <span style='color:#800000; font-weight:bold; '>break</span><span style='color:#800080; '>;</span>
251:                                 <span style='color:#800000; font-weight:bold; '>default</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Изменено "</span> <span style='color:#808030; '>+</span> updateRecords <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>" записей."</span><span style='color:#800080; '>;</span>
252:                             <span style='color:#800080; '>}</span>
253:                         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
254:                             resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.executeError"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> e<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
255:                             ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
256:                         <span style='color:#800080; '>}</span>
257:                     <span style='color:#800080; '>}</span>
258:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
259:                         connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
260:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
261:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
262:                     <span style='color:#800080; '>}</span>
263:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
264:                     resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.connectError"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
265:                 <span style='color:#800080; '>}</span>
266:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
267:                 resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.notRights"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
268:             <span style='color:#800080; '>}</span>
269:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
270:             <span style='color:#696969; '>// Удалить запись</span>
271:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>isAdministrator<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> tableQuery<span style='color:#808030; '>.</span>getUser<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getDelete<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
272:                 <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
273:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
274:                     <span style='color:#696969; '>// Сформировать SQL запрос</span>
275:                     <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"delete from "</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"schema"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'.'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>tableName<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" where "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
276:                     addKeyFieldsToSQL<span style='color:#808030; '>(</span>keys<span style='color:#808030; '>,</span> sql<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
277:                     <span style='color:#696969; '>// Выполнить сформированный запрос</span>
278:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>": "</span> <span style='color:#808030; '>+</span> sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
279:                     <span style='color:#bb7977; '>int</span> deleteRecords <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
280:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
281:                         <span style='color:#bb7977; font-weight:bold; '>Statement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>createStatement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
282:                         deleteRecords <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeUpdate<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
283:                         statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
284:                         <span style='color:#800000; font-weight:bold; '>switch</span> <span style='color:#808030; '>(</span>deleteRecords<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
285:                             <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Запись не удалена"</span><span style='color:#800080; '>;</span>
286:                                     <span style='color:#800000; font-weight:bold; '>break</span><span style='color:#800080; '>;</span>
287:                             <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Операция удаления записи выполнена успешно."</span><span style='color:#800080; '>;</span>
288:                                     execute <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
289:                                     <span style='color:#800000; font-weight:bold; '>break</span><span style='color:#800080; '>;</span>
290:                             <span style='color:#800000; font-weight:bold; '>default</span><span style='color:#808030; '>:</span> resultMessage <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Удалено "</span> <span style='color:#808030; '>+</span> deleteRecords <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>" записей."</span><span style='color:#800080; '>;</span>
291:                         <span style='color:#800080; '>}</span>
292:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
293:                         resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.executeError"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> e<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
294:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
295:                     <span style='color:#800080; '>}</span>
296:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
297:                         connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
298:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
299:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
300:                     <span style='color:#800080; '>}</span>
301:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
302:                     resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.connectError"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
303:                 <span style='color:#800080; '>}</span>
304:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
305:                 resultMessage <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"database.notRights"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
306:             <span style='color:#800080; '>}</span>
307:         <span style='color:#800080; '>}</span>
308: 
309:         <span style='color:#bb7977; font-weight:bold; '>String</span> title<span style='color:#800080; '>;</span>
310:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"delRecord"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
311:             title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"editRecordTitle"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
312:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
313:             title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"deleteRecordTitle"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
314:         <span style='color:#800080; '>}</span>
315:         <span style='color:#800000; font-weight:bold; '>return</span> getHtmlResultPage<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> tableQuery<span style='color:#808030; '>,</span> user<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>,</span> title<span style='color:#808030; '>,</span> resultMessage<span style='color:#808030; '>,</span> execute<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
316:     <span style='color:#800080; '>}</span>
317: 
318:     <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> getFormRecord<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
319:         attributes<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"nocache"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"yes"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
320:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> form <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
321:         <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> values <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
322:         TableQuery tableQuery <span style='color:#808030; '>=</span> initFields<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
323:         <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
324:         <span style='color:#bb7977; font-weight:bold; '>String</span> startName <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"startName"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>""</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
325:         <span style='color:#696969; '>// Получить вектор ключевых полей</span>
326:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> keys <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getKeys<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
327:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;html>&lt;head>&lt;title>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
328:         <span style='color:#bb7977; font-weight:bold; '>String</span> action <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"action"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
329:         <span style='color:#bb7977; font-weight:bold; '>String</span> title<span style='color:#800080; '>;</span>
330:         <span style='color:#bb7977; '>boolean</span> add <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"add"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>action<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
331:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>add<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
332:             title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecordTitle"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
333:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
334:             title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"editRecordTitle"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
335:         <span style='color:#800080; '>}</span>
336:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>title<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
337:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/title>&lt;/head>&lt;body>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
338:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;center>&lt;h1>"</span> <span style='color:#808030; '>+</span> title <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/h1>&lt;/center>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
339: 
340:         <span style='color:#bb7977; font-weight:bold; '>String</span> uri <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"uri"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
341:         <span style='color:#bb7977; font-weight:bold; '>String</span> actionForm <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"actionForm"</span><span style='color:#808030; '>,</span> uri<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
342:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;form method=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>POST</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> action=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> actionForm <span style='color:#808030; '>+</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
343: 
344:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>add<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
345:             <span style='color:#696969; '>// Получить запись по уникальному ключу</span>
346:             <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
347:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
348:                 <span style='color:#696969; '>// Сформировать SQL запрос</span>
349: <span style='color:#696969; '>//                StringBuffer sql = new StringBuffer(ssvt.getProperty(tableName + '.' + "getRecords"));</span>
350:                 <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span>getRecordsSQL<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> tableName<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
351:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>keys<span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
352:                     sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" where "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
353:                     addKeyFieldsToSQL<span style='color:#808030; '>(</span>keys<span style='color:#808030; '>,</span> sql<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
354:                     <span style='color:#696969; '>// Выполнить сформированный запрос и занести значения полей в [values]</span>
355:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>": "</span> <span style='color:#808030; '>+</span> sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
356:                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
357:                         <span style='color:#bb7977; font-weight:bold; '>PreparedStatement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>prepareStatement<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
358:                         <span style='color:#bb7977; font-weight:bold; '>ResultSet</span> record <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeQuery<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
359:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>record<span style='color:#808030; '>.</span>next<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
360:                             <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getSequence<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
361:                                 <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
362:                                 <span style='color:#bb7977; font-weight:bold; '>String</span> value <span style='color:#808030; '>=</span> record<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
363:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>value <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> 
364:                                     values<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> value<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
365:                             <span style='color:#800080; '>}</span>
366:                         <span style='color:#800080; '>}</span>
367:                         record<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
368:                         statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
369:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
370:                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
371:                     <span style='color:#800080; '>}</span>
372:                 <span style='color:#800080; '>}</span>
373:                 <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
374:                     connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
375:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
376:                     ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
377:                 <span style='color:#800080; '>}</span>
378:             <span style='color:#800080; '>}</span>
379:         <span style='color:#800080; '>}</span>
380: 
381:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>add <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>(</span>values<span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
382:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Запись для редактирования не найдена."</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
383:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
384:             <span style='color:#696969; '>// Вставить в форму невидимые поля </span>
385:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>HIDDEN</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>table</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
386:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>HIDDEN</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>action</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> action <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
387: 
388:             <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> buf<span style='color:#800080; '>;</span>
389:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>add<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
390:                 <span style='color:#696969; '>// Вставить в форму невидимые поля уникального ключа при редактировании записи</span>
391:                 <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> keys<span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
392:                     <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
393:                     <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
394:                     buf <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>HIDDEN</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>values<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
395:                     form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>buf<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
396:                 <span style='color:#800080; '>}</span>
397:             <span style='color:#800080; '>}</span>
398: 
399:             <span style='color:#bb7977; font-weight:bold; '>String</span> checkValue <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span><span style='color:#0000e6; '>"FORM"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"CHECKBOX"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"VALUE"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"YES"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
400:             <span style='color:#696969; '>// Вставить в форму редактируемые поля записи</span>
401:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;table>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
402:             <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getSequence<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
403:                 <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
404:                 <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
405:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>tableQuery<span style='color:#808030; '>.</span>isHiddenField<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getAttribute<span style='color:#808030; '>(</span>name<span style='color:#808030; '>.</span>substring<span style='color:#808030; '>(</span>startName<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
406:                     <span style='color:#bb7977; font-weight:bold; '>String</span> keyField <span style='color:#808030; '>=</span> tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"FORM"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> name<span style='color:#800080; '>;</span>
407:                     <span style='color:#bb7977; font-weight:bold; '>String</span> addField <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#800080; '>;</span>
408:                     buf <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;tr>&lt;td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
409:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> name<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/td>&lt;td>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&amp;nbsp;"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/td>&lt;td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
410:                     <span style='color:#bb7977; font-weight:bold; '>String</span> valueField <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> values<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
411:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>keys<span style='color:#808030; '>.</span>contains<span style='color:#808030; '>(</span>field<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>!</span>add<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
412:                         <span style='color:#696969; '>// При редактировании  поле уникального ключа недоступно для редактирования</span>
413:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>valueField <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
414:                             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;B>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>valueField<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/B>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
415:                         <span style='color:#800080; '>}</span>
416:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
417:                         <span style='color:#bb7977; font-weight:bold; '>String</span> objectName <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"INPUT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
418:                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>objectName<span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"INPUT"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
419:                             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
420:                             <span style='color:#bb7977; font-weight:bold; '>String</span> type <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"TYPE"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"TEXT"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
421:                             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>type<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
422:                             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#0000e6; '>"TEXT"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>type<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
423:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>valueField <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
424:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>valueField<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
425:                                 <span style='color:#800080; '>}</span>
426:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> MAXLENGTH=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
427:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getSize<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>></span> <span style='color:#008c00; '>64</span><span style='color:#808030; '>)</span> buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#008c00; '>64</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
428:                                 <span style='color:#800000; font-weight:bold; '>else</span> buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getSize<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
429:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> SIZE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getSize<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'\"'</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
430:                             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
431:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#0000e6; '>"CHECKBOX"</span><span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>type<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
432:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>checkValue<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
433:                                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>valueField <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> valueField<span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span>checkValue<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
434:                                         buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" CHECKED"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
435:                                     <span style='color:#800080; '>}</span>
436:                                 <span style='color:#800080; '>}</span> 
437:                             <span style='color:#800080; '>}</span>
438:                             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'>'</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
439:                         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
440:                             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>objectName<span style='color:#808030; '>.</span>equals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"SELECT"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
441:                                 addField <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"ADD"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
442:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;SELECT "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
443:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
444:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>">"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
445:                                 <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
446:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
447:                                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
448:                                         <span style='color:#bb7977; font-weight:bold; '>String</span> sql <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>keyField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"OPTIONS"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
449:                                         <span style='color:#bb7977; font-weight:bold; '>Statement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>createStatement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
450:                                         <span style='color:#bb7977; font-weight:bold; '>ResultSet</span> result <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeQuery<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
451:                                         <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span>result<span style='color:#808030; '>.</span>next<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
452:                                             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;OPTION>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
453:                                         <span style='color:#800080; '>}</span>
454:                                         result<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
455:                                         statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
456:                                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> sql<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
457:                                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
458:                                     <span style='color:#800080; '>}</span>
459:                                     <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
460:                                         connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
461:                                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> sql<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
462:                                         ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
463:                                     <span style='color:#800080; '>}</span>
464:                                 <span style='color:#800080; '>}</span>
465:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/SELECT>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
466:                             <span style='color:#800080; '>}</span>
467:                         <span style='color:#800080; '>}</span>
468:                     <span style='color:#800080; '>}</span>
469:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
470:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>addField <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
471:                         buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=SUBMIT NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> addField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>Изменить</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
472:                         buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=SUBMIT NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> keyField <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"ADD"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>Изменить</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
473:                     <span style='color:#800080; '>}</span> 
474:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
475:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/td>&lt;/tr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
476:                     form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>buf<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
477:                 <span style='color:#800080; '>}</span>
478:             <span style='color:#800080; '>}</span>
479: 
480:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>add<span style='color:#808030; '>)</span> form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;tr>&lt;td>"</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"deleteRecord"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/td>&lt;td>"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&amp;nbsp;"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/td>&lt;td>"</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;INPUT TYPE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>CHECKBOX</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>delRecord</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> checkValue <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>&lt;/td>&lt;/tr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
481:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/table>&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
482:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;INPUT TYPE=SUBMIT NAME=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>ENTER</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '> VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>Ввод</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;INPUT TYPE=RESET VALUE=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>Очистить</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>&lt;/form>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
483:         <span style='color:#800080; '>}</span>
484:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/body>&lt;/html>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
485:         <span style='color:#800000; font-weight:bold; '>return</span> form<span style='color:#800080; '>;</span>
486:     <span style='color:#800080; '>}</span>
487: 
488:     <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> getRecords<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
489:         TableQuery tableQuery <span style='color:#808030; '>=</span> initFields<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
490:         <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
491:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> sequence <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getSequence<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
492: 
493:         <span style='color:#bb7977; font-weight:bold; '>String</span> uri <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"uri"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
494:         <span style='color:#bb7977; font-weight:bold; '>String</span> uriTable <span style='color:#808030; '>=</span> uri <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"?table="</span> <span style='color:#808030; '>+</span> tableName<span style='color:#800080; '>;</span>
495:         <span style='color:#bb7977; font-weight:bold; '>String</span> addRecord <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecord"</span><span style='color:#808030; '>,</span> uriTable<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
496:         <span style='color:#bb7977; font-weight:bold; '>String</span> editRecord <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"editRecord"</span><span style='color:#808030; '>,</span> uriTable<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
497:         <span style='color:#bb7977; font-weight:bold; '>String</span> startName <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"startName"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>""</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
498:         <span style='color:#bb7977; font-weight:bold; '>String</span> maxRecords <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"maxRecords"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"100"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
499:         <span style='color:#bb7977; '>int</span> max<span style='color:#800080; '>;</span>
500:         <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
501:             max <span style='color:#808030; '>=</span> <span style='color:#bb7977; font-weight:bold; '>Integer</span><span style='color:#808030; '>.</span>parseInt<span style='color:#808030; '>(</span>maxRecords<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
502:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>max <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>)</span> max <span style='color:#808030; '>=</span> <span style='color:#008c00; '>50</span><span style='color:#800080; '>;</span>
503:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
504:             max <span style='color:#808030; '>=</span> <span style='color:#008c00; '>100</span><span style='color:#800080; '>;</span>
505:         <span style='color:#800080; '>}</span>
506: 
507:         <span style='color:#bb7977; font-weight:bold; '>String</span> strPage <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"page"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
508:         <span style='color:#bb7977; '>int</span> page<span style='color:#800080; '>;</span>
509:         <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
510:             page <span style='color:#808030; '>=</span> <span style='color:#bb7977; font-weight:bold; '>Integer</span><span style='color:#808030; '>.</span>parseInt<span style='color:#808030; '>(</span>strPage<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
511:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
512:             page <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
513:         <span style='color:#800080; '>}</span>
514: 
515: 
516:         <span style='color:#bb7977; '>boolean</span> insertLinks <span style='color:#808030; '>=</span> insertLinksToHTML<span style='color:#808030; '>(</span>user<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
517: 
518:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> form <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
519:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;html>&lt;head>&lt;title>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
520:         <span style='color:#bb7977; font-weight:bold; '>String</span> title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"title"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
521:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>title<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
522:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/title>&lt;/head>&lt;body>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
523: 
524: <span style='color:#696969; '>//        String script = ssvt.getProperty("script");</span>
525: <span style='color:#696969; '>//        if (script != null) </span>
526: <span style='color:#696969; '>//            form.addElement(script);</span>
527: 
528:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;center>&lt;h1>"</span> <span style='color:#808030; '>+</span> title <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/h1>&lt;/center>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
529: 
530:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"comment"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
531: 
532:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;center>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
533:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;table border width="</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"width"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"%95"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'>'</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
534:         <span style='color:#696969; '>// Вывести заголовок таблицы</span>
535:         <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> header <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;tr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
536:         <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> sequence<span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
537:             <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
538:             <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
539:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>tableQuery<span style='color:#808030; '>.</span>isHiddenField<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getAttribute<span style='color:#808030; '>(</span>name<span style='color:#808030; '>.</span>substring<span style='color:#808030; '>(</span>startName<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
540:                 header<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;th>"</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> name<span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/th>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
541:             <span style='color:#800080; '>}</span>
542:         <span style='color:#800080; '>}</span>
543:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>header<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/tr>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
544: 
545:         <span style='color:#bb7977; '>int</span> count <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span> <span style='color:#696969; '>// Количество выбранных записей</span>
546:         <span style='color:#696969; '>// Вывести тело таблицы</span>
547:         <span style='color:#bb7977; font-weight:bold; '>Connection</span> connection <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getConnection<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
548:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>connection <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
549:             <span style='color:#696969; '>// Сформировать SQL запрос</span>
550:             <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span>getRecordsSQL<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>,</span> tableName<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
551:             <span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
552:             <span style='color:#bb7977; '>boolean</span> whereIs <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>false</span><span style='color:#800080; '>;</span>
553:             <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> user<span style='color:#808030; '>.</span>getKeyAttributes<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
554:                 <span style='color:#bb7977; font-weight:bold; '>String</span> userNameAttribute <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
555:                 <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> tableQuery<span style='color:#808030; '>.</span>getField<span style='color:#808030; '>(</span>startName <span style='color:#808030; '>+</span> userNameAttribute<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
556:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>field <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
557:                     <span style='color:#bb7977; font-weight:bold; '>Object</span> value <span style='color:#808030; '>=</span> user<span style='color:#808030; '>.</span>getAttribute<span style='color:#808030; '>(</span>userNameAttribute<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
558:                     index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
559:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
560:                         sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" where "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
561:                         whereIs <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#800080; '>;</span>
562:                     <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
563:                         sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" and "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
564:                     <span style='color:#800080; '>}</span>
565:                     sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>' '</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>startName<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>userNameAttribute<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'='</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> value<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
566:                 <span style='color:#800080; '>}</span>
567:             <span style='color:#800080; '>}</span>
568:             <span style='color:#696969; '>// Добавить в SQL запрос условия выброки записей установленные пользователем</span>
569: 
570:             <span style='color:#696969; '>// Добавить в SQL запрос предикаты сортировки записей</span>
571: 
572: <span style='color:#696969; '>//            sql.append(" ");</span>
573: 
574:             <span style='color:#696969; '>// Выполнить запрос</span>
575:             <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
576: 
577:                 <span style='color:#bb7977; font-weight:bold; '>PreparedStatement</span> statement <span style='color:#808030; '>=</span> connection<span style='color:#808030; '>.</span>prepareStatement<span style='color:#808030; '>(</span>sql<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
578:                 <span style='color:#bb7977; font-weight:bold; '>ResultSet</span> result <span style='color:#808030; '>=</span> statement<span style='color:#808030; '>.</span>executeQuery<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
579:                 <span style='color:#bb7977; '>int</span> beginNumber <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>page <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>*</span> max<span style='color:#800080; '>;</span>
580:                 <span style='color:#bb7977; '>int</span> endNumber <span style='color:#808030; '>=</span> page <span style='color:#808030; '>*</span> max<span style='color:#800080; '>;</span>
581:                 <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span>result<span style='color:#808030; '>.</span>next<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
582:                     <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>count <span style='color:#808030; '>></span><span style='color:#808030; '>=</span> beginNumber<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>(</span>count <span style='color:#808030; '>&lt;</span> endNumber<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
583:                         <span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e<span style='color:#800080; '>;</span>
584:                         <span style='color:#696969; '>// Получить значения полей записи</span>
585:                         <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> values <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
586:                         <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span>e <span style='color:#808030; '>=</span> sequence<span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
587:                             <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
588:                             <span style='color:#bb7977; font-weight:bold; '>String</span> valueField <span style='color:#808030; '>=</span> result<span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
589:                             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>valueField <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> values<span style='color:#808030; '>.</span>put<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> valueField<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
590:                         <span style='color:#800080; '>}</span>
591:                         <span style='color:#696969; '>// Вывести запись</span>
592:                         <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> buf <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;tr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
593:                         <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span>e <span style='color:#808030; '>=</span> sequence<span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
594:                             <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
595:                             <span style='color:#bb7977; font-weight:bold; '>String</span> name <span style='color:#808030; '>=</span> field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
596:                             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>tableQuery<span style='color:#808030; '>.</span>isHiddenField<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> <span style='color:#808030; '>(</span>user<span style='color:#808030; '>.</span>getAttribute<span style='color:#808030; '>(</span>name<span style='color:#808030; '>.</span>substring<span style='color:#808030; '>(</span>startName<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
597:                                 index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
598:                                 <span style='color:#bb7977; font-weight:bold; '>String</span> valueField <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span>values<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>name<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
599:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
600:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>index <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> insertLinks<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
601:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;A HREF=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
602:                                     <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> link <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span>editRecord<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&amp;action=edit"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
603:                                     <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> keys <span style='color:#808030; '>=</span> tableQuery<span style='color:#808030; '>.</span>getKeys<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> keys<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> <span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
604:                                         <span style='color:#bb7977; font-weight:bold; '>Field</span> key <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> keys<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
605:                                         <span style='color:#bb7977; font-weight:bold; '>String</span> valueKey <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> values<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>key<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
606:                                         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>valueKey <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
607:                                             link<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'&amp;'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>key<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'='</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
608:                                             <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; '>int</span> pos <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span> pos <span style='color:#808030; '>&lt;</span> valueKey<span style='color:#808030; '>.</span>length<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> pos<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
609:                                                 <span style='color:#bb7977; '>char</span> c <span style='color:#808030; '>=</span> valueKey<span style='color:#808030; '>.</span>charAt<span style='color:#808030; '>(</span>pos<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
610: <span style='color:#696969; '>// если русские буквы ?</span>
611:                                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>c <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#0000e6; '>' '</span><span style='color:#808030; '>)</span> link<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"%20"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
612:                                                 <span style='color:#800000; font-weight:bold; '>else</span> link<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>c<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
613:                                             <span style='color:#800080; '>}</span>
614:                                         <span style='color:#800080; '>}</span>
615:                                     <span style='color:#800080; '>}</span>
616:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>link<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'\"'</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
617: <span style='color:#696969; '>//                                    if (script != null) buf.append(' ').append("onClick=\"return doClick(\'").append(link).append("\')\"");</span>
618:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'>'</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
619:                                 <span style='color:#800080; '>}</span>
620:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>valueField <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span>
621:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&amp;nbsp;"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
622:                                 <span style='color:#800000; font-weight:bold; '>else</span>
623:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>valueField<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
624:                                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>index <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span><span style='color:#808030; '>&amp;</span> insertLinks<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
625:                                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/A>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
626:                                 <span style='color:#800080; '>}</span>
627:                                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/td>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
628:                             <span style='color:#800080; '>}</span>
629:                         <span style='color:#800080; '>}</span>
630:                         buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/tr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
631:                         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>buf<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
632:                     <span style='color:#800080; '>}</span>
633:                     count<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
634:                 <span style='color:#800080; '>}</span>
635:                 result<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
636:                 statement<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
637:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
638:                 ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
639:             <span style='color:#800080; '>}</span>
640:             <span style='color:#800000; font-weight:bold; '>try</span> <span style='color:#800080; '>{</span>
641:                 connection<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
642:             <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>catch</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Exception</span> e<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
643:                 ssvt<span style='color:#808030; '>.</span>log<span style='color:#808030; '>(</span>e<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
644:             <span style='color:#800080; '>}</span>
645:         <span style='color:#800080; '>}</span>
646:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/table>&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
647:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/center>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
648:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Всего записей: "</span> <span style='color:#808030; '>+</span> count <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
649:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>count <span style='color:#808030; '>></span> max<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
650:             <span style='color:#bb7977; '>int</span> countPage <span style='color:#808030; '>=</span> count <span style='color:#808030; '>/</span> max<span style='color:#800080; '>;</span>
651:             <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>count <span style='color:#808030; '>%</span> max <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> countPage<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
652:             <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> buf <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Страницы: "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
653:             <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span> index <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>=</span> countPage<span style='color:#800080; '>;</span> index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
654:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> page<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
655:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;a href=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> uriTable <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&amp;page="</span> <span style='color:#808030; '>+</span> index <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> 
656:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
657:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;b>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
658:                 <span style='color:#800080; '>}</span>
659:                 buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>index<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
660:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> page<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
661:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/a>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
662:                 <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
663:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/b>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
664:                 <span style='color:#800080; '>}</span>
665:                 <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>&lt;</span> countPage<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
666:                     buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>", "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
667:                 <span style='color:#800080; '>}</span>
668:             <span style='color:#800080; '>}</span>
669:             buf<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
670:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>buf<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
671:         <span style='color:#800080; '>}</span>
672:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>insertLinks<span style='color:#808030; '>)</span> 
673:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;a href=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> addRecord <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&amp;action=add</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecord"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/a>&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
674:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/body>&lt;/html>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
675:         <span style='color:#800000; font-weight:bold; '>return</span> form<span style='color:#800080; '>;</span>
676:     <span style='color:#800080; '>}</span>
677: 
678:     <span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> getNoAccessPage<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
679:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> form <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
680:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;html>&lt;head>&lt;title>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
681:         <span style='color:#bb7977; font-weight:bold; '>String</span> title <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"titleNoAccessPage"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
682:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>title<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
683:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"messageNoAccessPage"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
684:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/body>&lt;/html>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
685:         <span style='color:#800000; font-weight:bold; '>return</span> form<span style='color:#800080; '>;</span>
686:     <span style='color:#800080; '>}</span>
687: 
688:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; '>void</span> addKeyFieldsToSQL<span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Vector</span> keys<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>StringBuffer</span> sql<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
689:         <span style='color:#bb7977; '>int</span> index <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
690:         <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Enumeration</span> e <span style='color:#808030; '>=</span> keys<span style='color:#808030; '>.</span>elements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> e<span style='color:#808030; '>.</span>hasMoreElements<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span> index<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
691:         <span style='color:#bb7977; font-weight:bold; '>Field</span> field <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span><span style='color:#808030; '>)</span> e<span style='color:#808030; '>.</span>nextElement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
692:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>index <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span> sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>" and "</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
693:             sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'='</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
694:             sql<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
695:         <span style='color:#800080; '>}</span>
696:     <span style='color:#800080; '>}</span>
697: 
698:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>String</span> getValueField<span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span> field<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
699:         <span style='color:#800000; font-weight:bold; '>return</span> getValueField<span style='color:#808030; '>(</span>field<span style='color:#808030; '>,</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
700:     <span style='color:#800080; '>}</span>
701: 
702:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>String</span> getValueField<span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>Field</span> field<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Object</span> object<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
703:         <span style='color:#800000; font-weight:bold; '>switch</span> <span style='color:#808030; '>(</span>field<span style='color:#808030; '>.</span>getType<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
704:             <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>
705:             <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#008c00; '>12</span><span style='color:#808030; '>:</span> <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#0000e6; '>'\''</span> <span style='color:#808030; '>+</span> object<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'\''</span><span style='color:#800080; '>;</span>
706:         <span style='color:#800080; '>}</span>
707:         <span style='color:#800000; font-weight:bold; '>return</span> object<span style='color:#808030; '>.</span>toString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
708:     <span style='color:#800080; '>}</span>
709: 
710:     <span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span> getHtmlResultPage<span style='color:#808030; '>(</span>ServerSSVT ssvt<span style='color:#808030; '>,</span> TableQuery table<span style='color:#808030; '>,</span> HttpUser user<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>Hashtable</span> attributes<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>String</span> title<span style='color:#808030; '>,</span> <span style='color:#bb7977; font-weight:bold; '>String</span> resultMessage<span style='color:#808030; '>,</span> <span style='color:#bb7977; '>boolean</span> execute<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
711:         <span style='color:#bb7977; font-weight:bold; '>Vector</span> form <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Vector</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
712:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;html>&lt;head>&lt;title>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
713:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>title<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
714:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/title>&lt;/head>&lt;body>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
715:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;center>&lt;h1>"</span> <span style='color:#808030; '>+</span> title <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/h1>&lt;/center>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
716:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>resultMessage<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
717:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;hr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
718:         <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>execute<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
719:             <span style='color:#bb7977; font-weight:bold; '>String</span> tableName <span style='color:#808030; '>=</span> table<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
720:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"admin.reloadMessage"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
721:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;hr>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
722:             <span style='color:#bb7977; font-weight:bold; '>String</span> uri <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#bb7977; font-weight:bold; '>String</span><span style='color:#808030; '>)</span> attributes<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"uri"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
723:             <span style='color:#bb7977; font-weight:bold; '>String</span> uriTable <span style='color:#808030; '>=</span> uri <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"?table="</span> <span style='color:#808030; '>+</span> tableName<span style='color:#800080; '>;</span>
724:             <span style='color:#bb7977; font-weight:bold; '>String</span> addRecord <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecord"</span><span style='color:#808030; '>,</span> uriTable<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
725:             <span style='color:#bb7977; font-weight:bold; '>String</span> viewRecords <span style='color:#808030; '>=</span> ssvt<span style='color:#808030; '>.</span>getProperty<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"title"</span><span style='color:#808030; '>,</span> uriTable<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
726: <span style='color:#696969; '>//            String page = (String) attributes.get("page");</span>
727: <span style='color:#696969; '>//            if (page != null) viewRecords = viewRecords + "&amp;page=" + page;</span>
728:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;a href=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> addRecord <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&amp;action=add</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"addRecord"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/a>&lt;br>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
729:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;a href=</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>"</span> <span style='color:#808030; '>+</span> viewRecords <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\"</span><span style='color:#0000e6; '>>"</span> <span style='color:#808030; '>+</span> ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span>tableName <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>'.'</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"title"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;/a>&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
730:         <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>else</span> <span style='color:#800080; '>{</span>
731:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"User ID: "</span> <span style='color:#808030; '>+</span> user<span style='color:#808030; '>.</span>getId<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
732:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Time : "</span> <span style='color:#808030; '>+</span> Function<span style='color:#808030; '>.</span>getTimeLabel<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#0000e6; '>"&lt;p>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
733:             form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span>ssvt<span style='color:#808030; '>.</span>getStringManager<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getString<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"admin.sendMessage"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
734:         <span style='color:#800080; '>}</span>
735:         form<span style='color:#808030; '>.</span>addElement<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"&lt;/body>&lt;/html>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
736:         <span style='color:#800000; font-weight:bold; '>return</span> form<span style='color:#800080; '>;</span>
737:     <span style='color:#800080; '>}</span>
738: 
739: <span style='color:#800080; '>}</span>
</pre></body></html>
