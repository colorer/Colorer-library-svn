 0:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>HTML</span><span style='color:#a65700; '>></span>
 1:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>HEAD</span><span style='color:#a65700; '>></span>
 2:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>TITLE</span><span style='color:#a65700; '>></span>This is a test of ADP<span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>TITLE</span><span style='color:#a65700; '>></span>
 3:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>HEAD</span><span style='color:#a65700; '>></span>
 4:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>BODY</span><span style='color:#a65700; '>></span>
 5:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>H1</span><span style='color:#a65700; '>></span>This is a test of ADP<span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>H1</span><span style='color:#a65700; '>></span>
 6:  <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#000000; background:#ffffe8; '></span>
 7: <span style='color:#000000; background:#ffffe8; '></span>
 8: <span style='color:#696969; background:#ffffe8; '> ## Proxies should cache this page for a maximum of 1 hour:</span><span style='color:#000000; background:#ffffe8; '></span>
 9: <span style='color:#000000; background:#ffffe8; '> ns_setexpires </span><span style='color:#000000; background:#ffffe8; '>$conn</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>3600</span><span style='color:#000000; background:#ffffe8; '></span>
10: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> host</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set iget </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_conn headers </span><span style='color:#000000; background:#ffffe8; '>$conn</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '> host</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
11: <span style='color:#000000; background:#ffffe8; '></span>
12: <span style='color:#696969; background:#ffffe8; '> ## How many times has this page been accessed</span><span style='color:#000000; background:#ffffe8; '></span>
13: <span style='color:#696969; background:#ffffe8; '> ## since the server was started?</span><span style='color:#000000; background:#ffffe8; '></span>
14: <span style='color:#000000; background:#ffffe8; '> ns_share </span><span style='color:#808030; background:#ffffe8; '>-</span><span style='color:#074726; background:#ffffe8; '>init</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> count</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>0</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '> count</span>
15: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>incr</span><span style='color:#000000; background:#ffffe8; '> count</span><span style='color:#000000; background:#ffffe8; '></span>
16: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#5f5035; background:#ffffe8; '>%></span>
17: 
18:  Number of accesses since server start: <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '>$count</span><span style='color:#5f5035; background:#ffffe8; '>%></span><span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>br</span><span style='color:#a65700; '>></span>
19:  tcl_version: <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '>$tcl_version</span><span style='color:#5f5035; background:#ffffe8; '>%></span><span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>br</span><span style='color:#a65700; '>></span>
20:  tcl_library: <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '>$tcl_library</span><span style='color:#5f5035; background:#ffffe8; '>%></span><span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>br</span><span style='color:#a65700; '>></span>
21:  Host: <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$host</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#5f5035; background:#ffffe8; '>%></span><span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>br</span><span style='color:#a65700; '>></span>
22: 
23:  <span style='color:#696969; '>&lt;!-- Include the contents of a file: --></span>
24:  <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#000000; background:#ffffe8; '></span>
25: <span style='color:#000000; background:#ffffe8; '> ns_adp_include standard</span><span style='color:#808030; background:#ffffe8; '>-</span><span style='color:#000000; background:#ffffe8; '>header</span>
26: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#5f5035; background:#ffffe8; '>%></span>
27: 
28:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>script language=tcl runat=server</span><span style='color:#a65700; '>></span>
29:  ## You can <span style='color:#800000; font-weight:bold; '>do</span> recursive ADP processing as well<span style='color:#800080; '>:</span>
30:  ns_adp_include time<span style='color:#808030; '>.</span>adp
31:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>script</span><span style='color:#a65700; '>></span>
32: 
33:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>P</span><span style='color:#a65700; '>></span>Here's an example of streaming:
34:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>script stream=on runat="server"</span><span style='color:#a65700; '>></span>
35:  ns_puts <span style='color:#800000; '>"</span><span style='color:#0000e6; '>&lt;br>1...&lt;br></span><span style='color:#800000; '>"</span>
36:  ns_sleep <span style='color:#008c00; '>2</span>
37:  ns_puts <span style='color:#800000; '>"</span><span style='color:#0000e6; '>2...&lt;br></span><span style='color:#800000; '>"</span>
38:  ns_sleep <span style='color:#008c00; '>2</span>
39:  ns_puts <span style='color:#800000; '>"</span><span style='color:#0000e6; '>3!&lt;br></span><span style='color:#800000; '>"</span>
40:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>script</span><span style='color:#a65700; '>></span>
41:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>p</span><span style='color:#a65700; '>></span><span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>b</span><span style='color:#a65700; '>></span>End<span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>b</span><span style='color:#a65700; '>></span>
42:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>BODY</span><span style='color:#a65700; '>></span>
43:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>HTML</span><span style='color:#a65700; '>></span>
44: 
