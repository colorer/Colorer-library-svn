<html><body style='color:#000000; background:#ffffff; '><pre>
 0: <span style='color:#800000; font-weight:bold; '>function</span> lab2_3<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
 1: 
 2: M1<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span>0 1<span style='color:#808030; '>]</span><span style='color:#808030; '>'</span><span style='color:#808030; '>;</span>
 3: M2<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span>1 <span style='color:#808030; '>-</span>1<span style='color:#808030; '>]</span><span style='color:#808030; '>'</span><span style='color:#808030; '>;</span>
 4: M3<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span><span style='color:#808030; '>-</span>2 1<span style='color:#808030; '>]</span><span style='color:#808030; '>'</span><span style='color:#808030; '>;</span>
 5: 
 6: 
 7: R1<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span><span style='color:#008000; '>0.4</span> <span style='color:#008000; '>0.1</span>
 8:     <span style='color:#008000; '>0.1</span> <span style='color:#008000; '>0.4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>;</span>
 9: 
10: R2<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span><span style='color:#008000; '>1.0</span> <span style='color:#808030; '>-</span><span style='color:#008000; '>0.1</span>
11:     <span style='color:#808030; '>-</span><span style='color:#008000; '>0.1</span> <span style='color:#008000; '>0.2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>;</span>
12: 
13: R3<span style='color:#808030; '>=</span><span style='color:#808030; '>[</span><span style='color:#008000; '>0.2</span> <span style='color:#808030; '>-</span><span style='color:#008000; '>0.1</span>
14:     <span style='color:#808030; '>-</span><span style='color:#008000; '>0.1</span> <span style='color:#008000; '>0.4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>;</span>
15: 
16: X1 <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>load</span><span style='color:#808030; '>(</span><span style='color:#800080; '>'x1.dat'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
17: X2 <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>load</span><span style='color:#808030; '>(</span><span style='color:#800080; '>'x2.dat'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
18: X3 <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>load</span><span style='color:#808030; '>(</span><span style='color:#800080; '>'x3.dat'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
19: 
20: <span style='color:#bb7977; '>plot</span><span style='color:#808030; '>(</span>X1<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>X1<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span><span style='color:#800080; '>'*r'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
21: <span style='color:#bb7977; '>hold</span> on
22: <span style='color:#bb7977; '>plot</span><span style='color:#808030; '>(</span>X2<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>X2<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span><span style='color:#800080; '>'+b'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
23: <span style='color:#bb7977; '>plot</span><span style='color:#808030; '>(</span>X3<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>X3<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span><span style='color:#800080; '>'.g'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
24: 
25: Xc <span style='color:#808030; '>=</span> <span style='color:#808030; '>-</span><span style='color:#008000; '>1.055</span><span style='color:#808030; '>;</span>
26: 
27: DrawSeparator<span style='color:#808030; '>(</span> M1<span style='color:#808030; '>,</span> M2<span style='color:#808030; '>,</span> R1<span style='color:#808030; '>,</span> R2<span style='color:#808030; '>,</span> Xc<span style='color:#808030; '>,</span> 3<span style='color:#808030; '>,</span> X1<span style='color:#808030; '>,</span> X2<span style='color:#808030; '>,</span> 1<span style='color:#808030; '>,</span> 2 <span style='color:#808030; '>)</span>
28: DrawSeparator<span style='color:#808030; '>(</span> M1<span style='color:#808030; '>,</span> M3<span style='color:#808030; '>,</span> R1<span style='color:#808030; '>,</span> R3<span style='color:#808030; '>,</span> <span style='color:#808030; '>-</span>3<span style='color:#808030; '>,</span> Xc<span style='color:#808030; '>,</span> X1<span style='color:#808030; '>,</span> X3<span style='color:#808030; '>,</span> 1<span style='color:#808030; '>,</span> 3 <span style='color:#808030; '>)</span>
29: DrawSeparator<span style='color:#808030; '>(</span> M3<span style='color:#808030; '>,</span> M2<span style='color:#808030; '>,</span> R3<span style='color:#808030; '>,</span> R2<span style='color:#808030; '>,</span> <span style='color:#808030; '>-</span>3<span style='color:#808030; '>,</span> Xc<span style='color:#808030; '>,</span> X3<span style='color:#808030; '>,</span> X2<span style='color:#808030; '>,</span> 2<span style='color:#808030; '>,</span> 3 <span style='color:#808030; '>)</span>
30: 
31: <span style='color:#bb7977; '>axis</span><span style='color:#808030; '>(</span><span style='color:#808030; '>[</span><span style='color:#808030; '>-</span>3 3 <span style='color:#808030; '>-</span><span style='color:#008000; '>2.5</span> 3<span style='color:#808030; '>]</span><span style='color:#808030; '>)</span>
32: 
33: <span style='color:#bb7977; '>hold</span> off
34: 
35: <span style='color:#800000; font-weight:bold; '>function</span> DrawSeparator<span style='color:#808030; '>(</span> M1<span style='color:#808030; '>,</span> M2<span style='color:#808030; '>,</span> R1<span style='color:#808030; '>,</span> R2<span style='color:#808030; '>,</span> x1<span style='color:#808030; '>,</span> x2<span style='color:#808030; '>,</span> X1<span style='color:#808030; '>,</span> X2<span style='color:#808030; '>,</span> n1<span style='color:#808030; '>,</span> n2 <span style='color:#808030; '>)</span>
36:   A <span style='color:#808030; '>=</span> R2<span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>-</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>-</span> R1<span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>-</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
37:   B <span style='color:#808030; '>=</span> 2 <span style='color:#808030; '>*</span> <span style='color:#808030; '>(</span> M1<span style='color:#800080; '>' * R1^(-1) - M2'</span> <span style='color:#808030; '>*</span> R2<span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>-</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
38:   c <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>log</span><span style='color:#808030; '>(</span> <span style='color:#bb7977; '>det</span><span style='color:#808030; '>(</span>R2<span style='color:#808030; '>)</span> <span style='color:#808030; '>/</span> <span style='color:#bb7977; '>det</span><span style='color:#808030; '>(</span>R1<span style='color:#808030; '>)</span> <span style='color:#808030; '>)</span> <span style='color:#808030; '>-</span> M1<span style='color:#800080; '>' * R1^(-1) * M1 + M2'</span> <span style='color:#808030; '>*</span> R2<span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>-</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>*</span> M2<span style='color:#808030; '>;</span>
39: 
40:   x <span style='color:#808030; '>=</span> x1 <span style='color:#808030; '>+</span> <span style='color:#808030; '>[</span>0<span style='color:#808030; '>:</span>20<span style='color:#808030; '>]</span><span style='color:#808030; '>/</span>20 <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> <span style='color:#808030; '>(</span>x2 <span style='color:#808030; '>-</span> x1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
41: 
42:   aX <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> x <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
43:   cX <span style='color:#808030; '>=</span> A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> <span style='color:#808030; '>(</span>x <span style='color:#808030; '>.</span><span style='color:#808030; '>^</span> 2<span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> x <span style='color:#808030; '>+</span> c<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
44: 
45:   y <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>-</span>aX <span style='color:#808030; '>+</span> <span style='color:#bb7977; '>sqrt</span><span style='color:#808030; '>(</span> aX<span style='color:#808030; '>.</span><span style='color:#808030; '>^</span>2 <span style='color:#808030; '>-</span> 4 <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> cX <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>/</span> <span style='color:#808030; '>(</span>2 <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
46: 
47:   <span style='color:#bb7977; '>plot</span><span style='color:#808030; '>(</span> x<span style='color:#808030; '>,</span> y<span style='color:#808030; '>,</span> <span style='color:#800080; '>'k'</span> <span style='color:#808030; '>)</span>
48: 
49:   <span style='color:#696969; '>% error probabilities</span>
50: 
51:   ErrF <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>inline</span><span style='color:#808030; '>(</span><span style='color:#800080; '>'(sign(x)+1)/2'</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
52:   N <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>length</span><span style='color:#808030; '>(</span>X1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
53: 
54:   discr <span style='color:#808030; '>=</span> A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span><span style='color:#808030; '>^</span>2 <span style='color:#808030; '>+</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span><span style='color:#808030; '>^</span>2 <span style='color:#808030; '>+</span> <span style='color:#808030; '>(</span>A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X1<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> c<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
55:   p1est <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>sum</span><span style='color:#808030; '>(</span> 1 <span style='color:#808030; '>-</span> ErrF<span style='color:#808030; '>(</span> discr <span style='color:#808030; '>)</span> <span style='color:#808030; '>)</span> <span style='color:#808030; '>/</span> N<span style='color:#808030; '>;</span>
56:   <span style='color:#bb7977; '>disp</span><span style='color:#808030; '>(</span> <span style='color:#808030; '>[</span><span style='color:#800080; '>'error '</span> int2str<span style='color:#808030; '>(</span>n1<span style='color:#808030; '>)</span> <span style='color:#800080; '>' &lt;=>  '</span> int2str<span style='color:#808030; '>(</span>n2<span style='color:#808030; '>)</span> <span style='color:#800080; '>' = '</span> num2str<span style='color:#808030; '>(</span>p1est<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>)</span>
57: 
58:   discr <span style='color:#808030; '>=</span> A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span><span style='color:#808030; '>^</span>2 <span style='color:#808030; '>+</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span><span style='color:#808030; '>^</span>2 <span style='color:#808030; '>+</span> <span style='color:#808030; '>(</span>A<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> A<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> B<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>2<span style='color:#808030; '>)</span> <span style='color:#808030; '>.</span><span style='color:#808030; '>*</span> X2<span style='color:#808030; '>(</span>2<span style='color:#808030; '>,</span><span style='color:#808030; '>:</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> c<span style='color:#808030; '>(</span>1<span style='color:#808030; '>,</span>1<span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
59:   p2est <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>sum</span><span style='color:#808030; '>(</span> ErrF<span style='color:#808030; '>(</span> discr <span style='color:#808030; '>)</span> <span style='color:#808030; '>)</span> <span style='color:#808030; '>/</span> N<span style='color:#808030; '>;</span>
60:   <span style='color:#bb7977; '>disp</span><span style='color:#808030; '>(</span> <span style='color:#808030; '>[</span><span style='color:#800080; '>'error '</span> int2str<span style='color:#808030; '>(</span>n2<span style='color:#808030; '>)</span> <span style='color:#800080; '>' &lt;=> '</span> int2str<span style='color:#808030; '>(</span>n1<span style='color:#808030; '>)</span> <span style='color:#800080; '>' = '</span> num2str<span style='color:#808030; '>(</span>p2est<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>)</span>
61: 
62:   p2avg <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>mean</span><span style='color:#808030; '>(</span><span style='color:#808030; '>[</span> p1est<span style='color:#808030; '>,</span> p2est <span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
63:   <span style='color:#bb7977; '>disp</span><span style='color:#808030; '>(</span> <span style='color:#808030; '>[</span><span style='color:#800080; '>'average '</span> int2str<span style='color:#808030; '>(</span>n1<span style='color:#808030; '>)</span> <span style='color:#800080; '>' &lt;=> '</span> int2str<span style='color:#808030; '>(</span>n2<span style='color:#808030; '>)</span> <span style='color:#800080; '>' = '</span> num2str<span style='color:#808030; '>(</span>p2avg<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>)</span>
64: 
65:   epsilon <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.05</span><span style='color:#808030; '>;</span>
66:   N_eps <span style='color:#808030; '>=</span> <span style='color:#bb7977; '>round</span><span style='color:#808030; '>(</span> <span style='color:#808030; '>(</span>1<span style='color:#808030; '>-</span>p2avg<span style='color:#808030; '>)</span><span style='color:#808030; '>/</span>epsilon<span style='color:#808030; '>^</span>2<span style='color:#808030; '>/</span>p2avg <span style='color:#808030; '>)</span><span style='color:#808030; '>;</span>
67:   <span style='color:#bb7977; '>disp</span><span style='color:#808030; '>(</span> <span style='color:#808030; '>[</span><span style='color:#800080; '>'N_eps '</span> int2str<span style='color:#808030; '>(</span>n1<span style='color:#808030; '>)</span> <span style='color:#800080; '>' &lt;=> '</span> int2str<span style='color:#808030; '>(</span>n2<span style='color:#808030; '>)</span> <span style='color:#800080; '>' = '</span> num2str<span style='color:#808030; '>(</span>N_eps<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>)</span>
68:   
</pre></body></html>
