 0: <span style='color:#696969; '>############################################################################</span>
 1: <span style='color:#696969; '>#</span>
 2: <span style='color:#696969; '>#    File:     colormap.icn</span>
 3: <span style='color:#696969; '>#</span>
 4: <span style='color:#696969; '>#    Subject:  Program to display palette from color list</span>
 5: <span style='color:#696969; '>#</span>
 6: <span style='color:#696969; '>#    Author:   Ralph E. Griswold</span>
 7: <span style='color:#696969; '>#</span>
 8: <span style='color:#696969; '>#    Date:     November 5, 1997</span>
 9: <span style='color:#696969; '>#</span>
10: <span style='color:#696969; '>############################################################################</span>
11: <span style='color:#696969; '>#</span>
12: <span style='color:#696969; '>#   This file is in the public domain.</span>
13: <span style='color:#696969; '>#</span>
14: <span style='color:#696969; '>############################################################################</span>
15: <span style='color:#696969; '>#</span>
16: <span style='color:#696969; '>#  This program shows the colors given color list files given on the</span>
17: <span style='color:#696969; '>#  command line.</span>
18: <span style='color:#696969; '>#</span>
19: <span style='color:#696969; '>#  The following options are supported:</span>
20: <span style='color:#696969; '>#</span>
21: <span style='color:#696969; '>#    -c i    number of color cells in a row, default 16</span>
22: <span style='color:#696969; '>#    -w i    width of color cell, default 20</span>
23: <span style='color:#696969; '>#</span>
24: <span style='color:#696969; '>#  colormap will display color lists with more than 256 entries but,</span>
25: <span style='color:#696969; '>#  of course, it cannot display more than 256 different colors (if that</span>
26: <span style='color:#696969; '>#  many).</span>
27: <span style='color:#696969; '>#</span>
28: <span style='color:#696969; '>############################################################################</span>
29: <span style='color:#696969; '>#</span>
30: <span style='color:#696969; '>#  Requires:  Version 9 graphics</span>
31: <span style='color:#696969; '>#</span>
32: <span style='color:#696969; '>############################################################################</span>
33: <span style='color:#696969; '>#</span>
34: <span style='color:#696969; '>#  Links:  colrlist, interact, io, options, wopen</span>
35: <span style='color:#696969; '>#</span>
36: <span style='color:#696969; '>############################################################################</span>
37: 
38: <span style='color:#004a43; '>$define CellWidth 20</span>
39: <span style='color:#004a43; '>$define Cells 16</span>
40: 
41: <span style='color:#800000; font-weight:bold; '>link</span> colrlist
42: <span style='color:#800000; font-weight:bold; '>link</span> interact
43: <span style='color:#800000; font-weight:bold; '>link</span> io
44: <span style='color:#800000; font-weight:bold; '>link</span> options
45: <span style='color:#800000; font-weight:bold; '>link</span> wopen
46: 
47: <span style='color:#800000; font-weight:bold; '>procedure</span> main<span style='color:#808030; '>(</span>args<span style='color:#808030; '>)</span>
48:    <span style='color:#800000; font-weight:bold; '>local</span> i<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> k<span style='color:#808030; '>,</span> clist<span style='color:#808030; '>,</span> depth<span style='color:#808030; '>,</span> opts<span style='color:#808030; '>,</span> width<span style='color:#808030; '>,</span> cells<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>file</span><span style='color:#808030; '>,</span> color
49: 
50:    opts <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> options<span style='color:#808030; '>(</span>args<span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>c+w+</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
51:    width <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#808030; '>\</span>opts<span style='color:#808030; '>[</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>w</span><span style='color:#800000; '>"</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>|</span> CellWidth
52:    cells <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#808030; '>\</span>opts<span style='color:#808030; '>[</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>c</span><span style='color:#800000; '>"</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>|</span> Cells
53: 
54:    <span style='color:#800000; font-weight:bold; '>every</span> <span style='color:#800000; font-weight:bold; '>file</span> <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#808030; '>!</span>args <span style='color:#800000; font-weight:bold; '>do</span> <span style='color:#800080; '>{</span>
55:       clist <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> colrlist<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>file</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span> <span style='color:#800080; '>{</span>
56:          Notice<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Cannot open window for </span><span style='color:#800000; '>"</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> image<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>file</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>.</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
57:          exit<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
58:          <span style='color:#800080; '>}</span>
59:       depth <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#808030; '>*</span>clist <span style='color:#808030; '>/</span> cells
60:       <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>*</span>clist <span style='color:#808030; '>%</span> cells <span style='color:#808030; '>~</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span> <span style='color:#800000; font-weight:bold; '>then</span> depth <span style='color:#808030; '>+</span><span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span>
61:       WOpen<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>size=</span><span style='color:#800000; '>"</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> cells <span style='color:#808030; '>*</span> width <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>,</span><span style='color:#800000; '>"</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> depth <span style='color:#808030; '>*</span> width<span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>bg=black</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span>
62:          stop<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>*** cannot open window for </span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> image<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>file</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
63:       <span style='color:#800000; font-weight:bold; '>every</span> j <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span> to depth <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>do</span>
64:          <span style='color:#800000; font-weight:bold; '>every</span> i <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span> to Cells <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>do</span> <span style='color:#800080; '>{</span>
65:             color <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> get<span style='color:#808030; '>(</span>clist<span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span> <span style='color:#800000; font-weight:bold; '>break</span> <span style='color:#800000; font-weight:bold; '>break</span>
66:             Fg<span style='color:#808030; '>(</span>color<span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span> <span style='color:#800080; '>{</span>
67:                Notice<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Cannot set foreground to </span><span style='color:#800000; '>"</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> image<span style='color:#808030; '>(</span>color<span style='color:#808030; '>)</span> <span style='color:#808030; '>|</span><span style='color:#808030; '>|</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>.</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
68:                exit<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
69:                <span style='color:#800080; '>}</span>
70:             FillRectangle<span style='color:#808030; '>(</span>i <span style='color:#808030; '>*</span> width <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> j <span style='color:#808030; '>*</span> width <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> width <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> width <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span>
71:             <span style='color:#800080; '>}</span>
72: 
73:       <span style='color:#696969; '># Fill out rest of window with patterned boxes.</span>
74: 
75:       Bg<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>dark gray</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
76:       Fg<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>black</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
77:       WAttrib<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>fillstyle=textured</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
78:       WAttrib<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>pattern=checkers</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
79: 
80:       <span style='color:#800000; font-weight:bold; '>every</span> k <span style='color:#808030; '>:</span><span style='color:#808030; '>=</span> i to width <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>do</span>
81:          FillRectangle<span style='color:#808030; '>(</span>k <span style='color:#808030; '>*</span> width <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> j <span style='color:#808030; '>*</span> width <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> width <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> width <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span>
82: 
83:       <span style='color:#800000; font-weight:bold; '>repeat</span> <span style='color:#800000; font-weight:bold; '>case</span> Event<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>of</span> <span style='color:#800080; '>{</span>
84:          <span style='color:#800000; '>"</span><span style='color:#0000e6; '>n</span><span style='color:#800000; '>"</span><span style='color:#808030; '>:</span>  <span style='color:#800000; font-weight:bold; '>break</span>
85:          <span style='color:#800000; '>"</span><span style='color:#0000e6; '>q</span><span style='color:#800000; '>"</span><span style='color:#808030; '>:</span>  exit<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
86:          <span style='color:#800000; '>"</span><span style='color:#0000e6; '>s</span><span style='color:#800000; '>"</span><span style='color:#808030; '>:</span>  <span style='color:#800080; '>{</span>
87:             Fg<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>black</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
88:             Bg<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>light gray</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span>
89:             snapshot<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
90:             <span style='color:#800080; '>}</span>
91:          <span style='color:#800080; '>}</span>
92:       WClose<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
93:       <span style='color:#800080; '>}</span>
94: <span style='color:#800000; font-weight:bold; '>end</span>
95: 
