  0: { =====================================================================
  1: ANS <span style='color:#800000; font-weight:bold; '>Forth</span> Test Suite
  2: 
  3: Copyright (<span style='color:#008c00; '>c</span>) <span style='color:#008c00; '>1998</span>, FORTH, Incorporated
  4: 
  5: This set <span style='color:#e34adc; '>of</span> tests has been taken from John Hayes' original Core.fr
  6: Dated Mon, <span style='color:#008c00; '>27</span> Nov <span style='color:#008c00; '>95</span> <span style='color:#008c00; '>13</span>:<span style='color:#008c00; '>10</span>.  We retain the following statement as
  7: required for its use:
  8: 
  9: (<span style='color:#008c00; '>C</span>) <span style='color:#008c00; '>1995</span> JOHNS HOPKINS UNIVERSITY <span style='color:#800000; font-weight:bold; '>/</span> APPLIED PHYSICS LABORATORY
 10: MAY <span style='color:#008c00; '>BE</span> DISTRIBUTED FREELY AS LONG AS THIS COPYRIGHT NOTICE REMAINS.
 11: 
 12: His last know update was VERSION <span style='color:#008c00; '>1</span>.<span style='color:#008c00; '>2</span>
 13: 
 14: This program tests the core <span style='color:#800000; font-weight:bold; '>words</span> <span style='color:#e34adc; '>of</span> an ANS <span style='color:#800000; font-weight:bold; '>Forth</span> system.
 15: The program assumes <span style='color:#008c00; '>a</span> two's complement implementation where
 16: the range <span style='color:#e34adc; '>of</span> signed numbers <span style='color:#800000; font-weight:bold; '>is</span> -<span style='color:#008c00; '>2</span>^(n-<span style='color:#008c00; '>1</span>) ... <span style='color:#008c00; '>2</span>^(n-<span style='color:#008c00; '>1</span>)-<span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>and</span>
 17: the range <span style='color:#e34adc; '>of</span> unsigned numbers <span style='color:#800000; font-weight:bold; '>is</span> <span style='color:#008c00; '>0</span> ... <span style='color:#008c00; '>2</span>^(n)-<span style='color:#008c00; '>1</span>.
 18: 
 19: Missing test: negative <span style='color:#800000; font-weight:bold; '>ALLOT</span>
 20: TBD: How <span style='color:#800000; font-weight:bold; '>to</span> <span style='color:#800000; font-weight:bold; '>find</span> number <span style='color:#e34adc; '>of</span> bits?
 21: 
 22: Dependencies: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#800000; font-weight:bold; '>-></span> } { {{ TESTING MSB 1S &lt;FALSE> &lt;TRUE>
 23: 
 24: Exports:
 25: 
 26: ===================================================================== }
 27: 
 28: <span style='color:#e34adc; '>HEX</span>
 29: 
 30: TESTING <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#800000; font-weight:bold; '>,</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#008c00; '>C</span>, <span style='color:#008c00; '>C</span>@ <span style='color:#008c00; '>C</span>! <span style='color:#800000; font-weight:bold; '>CHARS</span> <span style='color:#008c00; '>2</span>@ <span style='color:#008c00; '>2</span>! <span style='color:#800000; font-weight:bold; '>ALIGN</span> <span style='color:#800000; font-weight:bold; '>ALIGNED</span> <span style='color:#800000; font-weight:bold; '>+!</span> <span style='color:#800000; font-weight:bold; '>ALLOT</span>
 31: 
 32: <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>ALLOT</span>
 33: <span style='color:#800000; font-weight:bold; '>HERE</span>
 34: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>2NDA</span>
 35: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>1STA</span>
 36: {<span style='color:#800000; font-weight:bold; '>></span> 1STA 2NDA <span style='color:#800000; font-weight:bold; '>U&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;TRUE> }              <span style='color:#696969; '>\ Here must grow with allot</span>
 37: {<span style='color:#800000; font-weight:bold; '>></span> 1STA <span style='color:#008c00; '>1</span>+ <span style='color:#800000; font-weight:bold; '>-></span> 2NDA }                     <span style='color:#696969; '>\ ... by one address unit</span>
 38: 
 39: <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>,</span>
 40: <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>2</span> <span style='color:#800000; font-weight:bold; '>,</span>
 41: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>2ND</span>
 42: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>1ST</span>
 43: {<span style='color:#800000; font-weight:bold; '>></span> 1ST 2ND <span style='color:#800000; font-weight:bold; '>U&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;TRUE> }                <span style='color:#696969; '>\ Here must grow with allot</span>
 44: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#800000; font-weight:bold; '>-></span> 2ND }                    <span style='color:#696969; '>\ ... by one cell</span>
 45: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#800000; font-weight:bold; '>+</span> <span style='color:#800000; font-weight:bold; '>-></span> 2ND }
 46: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#800000; font-weight:bold; '>@</span> 2ND <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>1</span> <span style='color:#008c00; '>2</span> }
 47: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>5</span> 1ST <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#800000; font-weight:bold; '>-></span> }
 48: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#800000; font-weight:bold; '>@</span> 2ND <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>5</span> <span style='color:#008c00; '>2</span> }
 49: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>6</span> 2ND <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#800000; font-weight:bold; '>-></span> }
 50: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#800000; font-weight:bold; '>@</span> 2ND <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>5</span> <span style='color:#008c00; '>6</span> }
 51: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#008c00; '>2</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>6</span> <span style='color:#008c00; '>5</span> }
 52: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>2</span> <span style='color:#008c00; '>1</span> 1ST <span style='color:#008c00; '>2</span>! <span style='color:#800000; font-weight:bold; '>-></span> }
 53: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#008c00; '>2</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>2</span> <span style='color:#008c00; '>1</span> }
 54: {<span style='color:#800000; font-weight:bold; '>></span> 1S 1ST <span style='color:#800000; font-weight:bold; '>!</span>  1ST <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> 1S }               <span style='color:#696969; '>\ Can store cell-wide value</span>
 55: 
 56: <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>1</span> <span style='color:#008c00; '>C</span>,
 57: <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>2</span> <span style='color:#008c00; '>C</span>,
 58: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>2NDC</span>
 59: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>1STC</span>
 60: {<span style='color:#800000; font-weight:bold; '>></span> 1STC 2NDC <span style='color:#800000; font-weight:bold; '>U&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;TRUE> }              <span style='color:#696969; '>\ Here must grow with allot</span>
 61: {<span style='color:#800000; font-weight:bold; '>></span> 1STC <span style='color:#800000; font-weight:bold; '>CHAR+</span> <span style='color:#800000; font-weight:bold; '>-></span> 2NDC }                  <span style='color:#696969; '>\ ... by one char</span>
 62: {<span style='color:#800000; font-weight:bold; '>></span> 1STC <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CHARS</span> <span style='color:#800000; font-weight:bold; '>+</span> <span style='color:#800000; font-weight:bold; '>-></span> 2NDC }
 63: {<span style='color:#800000; font-weight:bold; '>></span> 1STC <span style='color:#008c00; '>C</span>@ 2NDC <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>1</span> <span style='color:#008c00; '>2</span> }
 64: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>3</span> 1STC <span style='color:#008c00; '>C</span>! <span style='color:#800000; font-weight:bold; '>-></span> }
 65: {<span style='color:#800000; font-weight:bold; '>></span> 1STC <span style='color:#008c00; '>C</span>@ 2NDC <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>3</span> <span style='color:#008c00; '>2</span> }
 66: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>4</span> 2NDC <span style='color:#008c00; '>C</span>! <span style='color:#800000; font-weight:bold; '>-></span> }
 67: {<span style='color:#800000; font-weight:bold; '>></span> 1STC <span style='color:#008c00; '>C</span>@ 2NDC <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>3</span> <span style='color:#008c00; '>4</span> }
 68: 
 69: <span style='color:#800000; font-weight:bold; '>ALIGN</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>ALLOT</span> <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#800000; font-weight:bold; '>ALIGN</span> <span style='color:#800000; font-weight:bold; '>HERE</span> <span style='color:#008c00; '>3</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#800000; font-weight:bold; '>ALLOT</span>
 70: <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>A-ADDR</span>  <span style='color:#800000; font-weight:bold; '>CONSTANT </span><span style='color:#000000; background:#a8a800; '>UA-ADDR</span>
 71: {<span style='color:#800000; font-weight:bold; '>></span> UA-ADDR <span style='color:#800000; font-weight:bold; '>ALIGNED</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>A</span>-ADDR }
 72: {<span style='color:#800000; font-weight:bold; '>></span>    <span style='color:#008c00; '>1</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#008c00; '>C</span>!  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span>    <span style='color:#008c00; '>1</span> }
 73: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1234</span> <span style='color:#008c00; '>A</span>-ADDR  <span style='color:#800000; font-weight:bold; '>!</span>  <span style='color:#008c00; '>A</span>-ADDR  <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>1234</span> }
 74: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>123</span> <span style='color:#008c00; '>456</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#008c00; '>2</span>!  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#008c00; '>2</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>123</span> <span style='color:#008c00; '>456</span> }
 75: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>2</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CHAR+</span> <span style='color:#008c00; '>C</span>!  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CHAR+</span> <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>2</span> }
 76: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>3</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#008c00; '>C</span>!  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#008c00; '>C</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>3</span> }
 77: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1234</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#800000; font-weight:bold; '>!</span>  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>1234</span> }
 78: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>123</span> <span style='color:#008c00; '>456</span> <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#008c00; '>2</span>!  <span style='color:#008c00; '>A</span>-ADDR <span style='color:#800000; font-weight:bold; '>CELL+</span> <span style='color:#008c00; '>2</span>@ <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>123</span> <span style='color:#008c00; '>456</span> }
 79: 
 80: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>BITS</span> <span style='color:#696969; '>( X -- U )</span>
 81:    <span style='color:#008c00; '>0</span> <span style='color:#800000; font-weight:bold; '>SWAP</span> <span style='color:#e34adc; '>BEGIN</span>
 82:       <span style='color:#800000; font-weight:bold; '>DUP</span> <span style='color:#e34adc; '>WHILE</span>
 83:          <span style='color:#800000; font-weight:bold; '>DUP</span> MSB <span style='color:#800000; font-weight:bold; '>AND</span> <span style='color:#e34adc; '>IF</span>
 84:             <span style='color:#800000; font-weight:bold; '>>R</span> <span style='color:#008c00; '>1</span>+ <span style='color:#800000; font-weight:bold; '>R></span>
 85:    <span style='color:#e34adc; '>THEN</span>  <span style='color:#008c00; '>2</span>*  <span style='color:#e34adc; '>REPEAT</span>  <span style='color:#800000; font-weight:bold; '>DROP</span> ;
 86: 
 87: <span style='color:#696969; '>\ Characters >= 1 au, &lt;= size of cell, >= 8 bits</span>
 88: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CHARS</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;FALSE> }
 89: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CHARS</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#800000; font-weight:bold; '>></span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;FALSE> }
 90: 
 91: <span style='color:#696969; '>\ Cells >= 1 au, integral multiple of char size, >= 16 bits</span>
 92: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;FALSE> }
 93: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CELLS</span> <span style='color:#008c00; '>1</span> <span style='color:#800000; font-weight:bold; '>CHARS</span> <span style='color:#800000; font-weight:bold; '>MOD</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>0</span> }
 94: {<span style='color:#800000; font-weight:bold; '>></span> 1S BITS <span style='color:#008c00; '>10</span> <span style='color:#800000; font-weight:bold; '>&lt;</span> <span style='color:#800000; font-weight:bold; '>-></span> &lt;FALSE> }
 95: 
 96: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>0</span> 1ST <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#800000; font-weight:bold; '>-></span> }
 97: {<span style='color:#800000; font-weight:bold; '>></span> <span style='color:#008c00; '>1</span> 1ST <span style='color:#800000; font-weight:bold; '>+!</span> <span style='color:#800000; font-weight:bold; '>-></span> }
 98: {<span style='color:#800000; font-weight:bold; '>></span> 1ST <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>1</span> }
 99: {<span style='color:#800000; font-weight:bold; '>></span> -<span style='color:#008c00; '>1</span> 1ST <span style='color:#800000; font-weight:bold; '>+!</span> 1ST <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>-></span> <span style='color:#008c00; '>0</span> }
100: 
101: 
