<html><body style='color:#000000; background:#ffffff; '><pre>
  0: <span style='color:#696969; '>\ Client interface for BootMon. Chapter 6</span>
  1: <span style='color:#0000e6; '>." Client interface"</span>
  2: include? task-rp.fth rp.fth anew task-ClientInt.fth <span style='color:#e34adc; '>decimal</span>
  3: <span style='color:#800000; font-weight:bold; '>vocabulary</span> client <span style='color:#800000; font-weight:bold; '>also</span> client <span style='color:#000000; background:#a8a800; '>definitions</span>
  4: <span style='color:#007997; '>dictlist</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>cell+</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>value</span> clientvoc <span style='color:#696969; '>\ Adr vocabulary of client interface</span>
  5: 
  6: <span style='color:#696969; '>\ Convert zerro terminated string to S" string</span>
  7: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>z>s-string</span> <span style='color:#696969; '>( Azstr -- A L )</span> <span style='color:#800000; font-weight:bold; '>dup</span>
  8:     <span style='color:#008c00; '>0</span> <span style='color:#e34adc; '>begin</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#008c00; '>c</span>@ <span style='color:#e34adc; '>while</span> <span style='color:#008c00; '>1</span>+ <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#008c00; '>1</span>+ <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#e34adc; '>repeat</span> <span style='color:#696969; '>( A Aend L )</span>
  9:     <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#008c00; '>1</span>- <span style='color:#696969; '>( A L )</span> ;
 10: <span style='color:#696969; '>\ Test of existanse target method</span>
 11: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>test</span> <span style='color:#696969; '>( Azstr -- F/T )</span> z>s-string
 12:     clientvoc vfind <span style='color:#696969; '>( XtW 1 | endVoc 0 )</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>not</span> <span style='color:#696969; '>( F/T )</span> ;
 13: <span style='color:#696969; '>\ Peer</span>
 14: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>Psibl</span> <span style='color:#696969; '>( Phandle )</span> <span style='color:#800000; font-weight:bold; '>>code</span> siblinghandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#696969; '>( SiblingHandle )</span> ;
 15: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>Proot</span> <span style='color:#696969; '>( Phandle )</span> <span style='color:#800000; font-weight:bold; '>drop</span> roothandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#696969; '>( SiblingHandle )</span> ;
 16: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>peer</span>  <span style='color:#696969; '>( Phandle )</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#007997; '>br0</span> Proot Psibl <span style='color:#696969; '>( SiblingHandle )</span> ; <span style='color:#696969; '>\ ++ 16-02-2000</span>
 17: <span style='color:#696969; '>\ Child</span>
 18: <span style='color:#696969; '>\ : child ( Phandle ) >code childhandle @ ( ChildHandle ) ;</span>
 19: <span style='color:#696969; '>\ getproplen</span>
 20: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>getproplen</span> <span style='color:#696969; '>( Azstr Phandle -- Len | F )</span>
 21:     <span style='color:#800000; font-weight:bold; '>swap</span> z>s-string <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#696969; '>( A L Phandle )</span> getPhandleProperty
 22:     <span style='color:#696969; '>( Adr Len False | True  )</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>not</span> <span style='color:#e34adc; '>if</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( Lprop )</span> ; <span style='color:#696969; '>\ ++ 16-02-2000</span>
 23: <span style='color:#696969; '>\ getprop</span>
 24: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>getprop</span> <span style='color:#696969; '>( LenBuf AdrBuf Azstr Phandle -- Len | F )</span>
 25:     <span style='color:#800000; font-weight:bold; '>swap</span> z>s-string <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#696969; '>( LenBuf AdrBuf A L Phandle )</span> getPhandleProperty
 26:     <span style='color:#696969; '>( LenBuf AdrBuf Adr Len False | True )</span> <span style='color:#800000; font-weight:bold; '>not</span>
 27:     <span style='color:#e34adc; '>if</span>  <span style='color:#696969; '>( LenBuf AdrBuf Adr Len )</span>
 28:         <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#696969; '>( Adr AdrBuf Len LenBuf AdrBuf )</span>
 29:         <span style='color:#800000; font-weight:bold; '>min</span> <span style='color:#696969; '>( Adr AdrBuf LenMin )</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#800000; font-weight:bold; '>move</span> <span style='color:#800000; font-weight:bold; '>r></span> <span style='color:#696969; '>( Len )</span>
 30:     <span style='color:#e34adc; '>else</span> <span style='color:#696969; '>( AdrBuf LenBuf )</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>true</span> <span style='color:#696969; '>( T )</span> <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( Lprop )</span> ; <span style='color:#696969; '>\ ++ 16-02-2000</span>
 31: <span style='color:#696969; '>\ nextprop</span>
 32: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>nextprop</span> <span style='color:#696969; '>( AdrBuf Azstr Phandle -- T | F )</span>
 33:     <span style='color:#800000; font-weight:bold; '>swap</span> z>s-string <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#696969; '>( AdrBuf A L Phandle )</span>
 34:     next-property <span style='color:#696969; '>( AdrBuf Anp Lnp T | AdrBuf F )</span>
 35:     <span style='color:#e34adc; '>if</span> <span style='color:#696969; '>( AdrBuf Anp Lnp )</span>
 36:         <span style='color:#008c00; '>2</span> <span style='color:#800000; font-weight:bold; '>pick</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#800000; font-weight:bold; '>+</span> <span style='color:#008c00; '>1</span>+ <span style='color:#008c00; '>0</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#008c00; '>c</span>! <span style='color:#696969; '>\ Write 0 for zerro terminated string</span>
 37:         <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>-rot</span> <span style='color:#800000; font-weight:bold; '>move</span> <span style='color:#800000; font-weight:bold; '>r></span> <span style='color:#696969; '>( L )</span>
 38:     <span style='color:#e34adc; '>else</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>false</span> <span style='color:#696969; '>( F )</span> <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( L )</span> ; <span style='color:#696969; '>\ ++ 16-02-2000</span>
 39: 
 40: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>setprop</span> <span style='color:#696969; '>( Len Buf SnameProp Phandle -- Size )</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#008c00; '>4</span> <span style='color:#800000; font-weight:bold; '>mod</span>
 41:     <span style='color:#e34adc; '>if</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>true</span>
 42:     <span style='color:#e34adc; '>else</span>
 43:         provphandle <span style='color:#696969; '>( ... Phandle/T )</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>true</span> <span style='color:#800000; font-weight:bold; '>=</span>
 44:         <span style='color:#e34adc; '>if</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>true</span>
 45:         <span style='color:#e34adc; '>else</span>
 46:             <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#007997; '>encode-string</span> <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#696969; '>( Buf Len Sname Phandle )</span>
 47:             <span style='color:#800000; font-weight:bold; '>swap</span> z>s-string <span style='color:#800000; font-weight:bold; '>2DUP</span> <span style='color:#800000; font-weight:bold; '>TYPE</span> <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#696969; '>( Buf Len A L Phandle )</span>
 48:             nodehandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>>r</span> nodehandle <span style='color:#800000; font-weight:bold; '>!</span>
 49:             <span style='color:#800000; font-weight:bold; '>.S</span> <span style='color:#007997; '>property</span> <span style='color:#696969; '>\ Change value or make new property</span>
 50:             <span style='color:#800000; font-weight:bold; '>r></span> nodehandle <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#800000; font-weight:bold; '>r></span> <span style='color:#696969; '>( Len )</span>
 51:         <span style='color:#e34adc; '>then</span>
 52:     <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( T | size )</span> ; <span style='color:#696969; '>\ ++ 17-02-2000</span>
 53: 
 54: <span style='color:#696969; '>\ Instance-to-package</span>
 55: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>proverprototype</span> <span style='color:#696969; '>( Ihandle -- Phandle | T )</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#696969; '>\ Get prototip phandle</span>
 56:     provphandle <span style='color:#696969; '>( Phandle | T )</span> ;
 57: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>instance-to-package</span> <span style='color:#696969; '>( Ihandle -- Phandle | T )</span>
 58:     <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#008c00; '>4</span> <span style='color:#800000; font-weight:bold; '>mod</span> <span style='color:#e34adc; '>if</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>true</span> <span style='color:#e34adc; '>else</span> proverprototype <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( Phandle | T )</span> ;
 59: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>getnamepnode</span> <span style='color:#696969; '>( Phandle Lbuf Abuf )</span>
 60:     <span style='color:#800000; font-weight:bold; '>rot</span><span style='color:#0000e6; '> s" name"</span> <span style='color:#800000; font-weight:bold; '>rot</span> getPhandleProperty <span style='color:#696969; '>( A L 0 | T )</span> ;
 61: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>fullstore</span> <span style='color:#696969; '>( Lbuf Abuf A L )</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#008c00; '>2</span> <span style='color:#800000; font-weight:bold; '>pick</span> <span style='color:#008c00; '>2</span> <span style='color:#800000; font-weight:bold; '>pick</span> <span style='color:#800000; font-weight:bold; '>move</span> <span style='color:#696969; '>( Lbuf Abuf L )</span>
 62:     <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#800000; font-weight:bold; '>+</span> <span style='color:#800000; font-weight:bold; '>-rot</span> <span style='color:#800000; font-weight:bold; '>-</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#696969; '>( Lbuf Abuf )</span> ;
 63: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>ukorot</span> <span style='color:#696969; '>( Lbuf Abuf A L )</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#696969; '>( Lbuf Abuf A Abuf )</span> <span style='color:#008c00; '>3</span> <span style='color:#800000; font-weight:bold; '>pick</span> <span style='color:#800000; font-weight:bold; '>move</span>
 64:     <span style='color:#696969; '>( Lbuf Abuf )</span> <span style='color:#800000; font-weight:bold; '>+</span> <span style='color:#008c00; '>0</span> <span style='color:#800000; font-weight:bold; '>swap</span>  <span style='color:#696969; '>( Lbuf Abuf )</span> ;
 65: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>storename</span> <span style='color:#696969; '>( Lbuf Abuf A L )</span>
 66:     <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#0000e6; '>ascii /</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#008c00; '>c</span>! <span style='color:#008c00; '>1</span>+ <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#008c00; '>1</span>- <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#696969; '>( Lbuf-1 Abuf+1 A L )</span>
 67:     <span style='color:#008c00; '>3</span> <span style='color:#800000; font-weight:bold; '>pick</span> <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#800000; font-weight:bold; '>&lt;</span> <span style='color:#e34adc; '>if</span> ukorot <span style='color:#e34adc; '>else</span> fullstore <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( Lbuf-L Abuf+L )</span> ;
 68: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>getbyroot</span> <span style='color:#696969; '>( Phandle -- PhandleN ...... PhandleR N )</span>
 69:     <span style='color:#008c00; '>2</span> <span style='color:#696969; '>( Phandle 1 )</span>
 70:     <span style='color:#e34adc; '>begin</span>
 71:         <span style='color:#800000; font-weight:bold; '>over</span> parent <span style='color:#696969; '>( Parent )</span>
 72:         <span style='color:#800000; font-weight:bold; '>dup</span>  parent roothandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>=</span> <span style='color:#800000; font-weight:bold; '>not</span> <span style='color:#696969; '>( ? Parent is Root )</span>
 73:     <span style='color:#e34adc; '>while</span>
 74:         <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#008c00; '>1</span>+
 75:     <span style='color:#e34adc; '>repeat</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#696969; '>( PhandleN ...... PhandleR N )</span> ;
 76: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>getnodepath</span> <span style='color:#696969; '>( Phandle )</span> <span style='color:#800000; font-weight:bold; '>dup</span> parent roothandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>=</span> <span style='color:#800000; font-weight:bold; '>not</span>
 77:     <span style='color:#e34adc; '>if</span> getbyroot <span style='color:#e34adc; '>else</span> <span style='color:#008c00; '>1</span> <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( Abuf PhandleN ...... PhandleR N )</span> ;
 78: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>upbychain</span> <span style='color:#696969; '>( Lbuf Abuf Phandle )</span>
 79:     <span style='color:#800000; font-weight:bold; '>over</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#800000; font-weight:bold; '>>r</span>
 80:     getnodepath <span style='color:#696969; '>( Abuf PhandleN ...... PhandleR N )</span>
 81:     <span style='color:#800000; font-weight:bold; '>r></span> <span style='color:#800000; font-weight:bold; '>r></span> <span style='color:#800000; font-weight:bold; '>rot</span> <span style='color:#008c00; '>0</span>
 82:     <span style='color:#e34adc; '>do</span>
 83:         getnamepnode <span style='color:#800000; font-weight:bold; '>not</span>
 84:         <span style='color:#e34adc; '>if</span>  <span style='color:#696969; '>( Abuf PhandleN ...... PhandleM Lbuf Abuf A L )</span>
 85:             <span style='color:#007997; '>decode-string</span> <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#800000; font-weight:bold; '>2drop</span> storename
 86:         <span style='color:#e34adc; '>then</span>
 87:     <span style='color:#e34adc; '>loop</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#800000; font-weight:bold; '>-</span> <span style='color:#696969; '>( LenPath )</span> ;
 88: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>package-to-path</span> <span style='color:#696969; '>( Lbuf Abuf Phandle -- LenPath )</span>
 89:     <span style='color:#800000; font-weight:bold; '>dup</span> provphandle <span style='color:#800000; font-weight:bold; '>true</span> <span style='color:#800000; font-weight:bold; '>=</span>
 90:     <span style='color:#e34adc; '>if</span>  <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#800000; font-weight:bold; '>true</span>
 91:     <span style='color:#e34adc; '>else</span> <span style='color:#696969; '>( Lbuf Abuf Phandle )</span> upbychain <span style='color:#696969; '>( LenPath )</span>
 92:     <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( LenPath )</span> ;
 93: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>pwd</span> <span style='color:#696969; '>( Phandle -- )</span> <span style='color:#008c00; '>200</span> <span style='color:#800000; font-weight:bold; '>here</span> <span style='color:#800000; font-weight:bold; '>rot</span> package-to-path
 94:     <span style='color:#800000; font-weight:bold; '>here</span> <span style='color:#800000; font-weight:bold; '>swap</span> <span style='color:#696969; '>( AdrPath LenPath )</span> <span style='color:#800000; font-weight:bold; '>type</span> <span style='color:#696969; '>( -- )</span> ;
 95: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>finddevice</span> <span style='color:#696969; '>( AdrZstring -- Phandle )</span> norealize ;
 96: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>canon</span> <span style='color:#696969; '>( Lbuf Abuf StringZSpecif -- LenPath )</span> norealize ;
 97: 
 98: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>gotoup</span> <span style='color:#696969; '>( A L )</span> <span style='color:#800000; font-weight:bold; '>2drop</span> nodehandle <span style='color:#007997; '>@nt</span> <span style='color:#800000; font-weight:bold; '>dup</span> roothandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>=</span> <span style='color:#800000; font-weight:bold; '>not</span>
 99:     <span style='color:#e34adc; '>if</span> parenthandle <span style='color:#800000; font-weight:bold; '>@</span> nodehandle <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( -- )</span> ;
100: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>gotodown</span> <span style='color:#696969; '>( A L )</span> <span style='color:#800000; font-weight:bold; '>type</span> <span style='color:#696969; '>( -- )</span> norealize ;
101: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>tcd</span> <span style='color:#696969; '>( -- )</span> <span style='color:#800000; font-weight:bold; '>bl</span> <span style='color:#800000; font-weight:bold; '>word</span> <span style='color:#800000; font-weight:bold; '>count</span> <span style='color:#696969; '>( A L )</span> <span style='color:#800000; font-weight:bold; '>2dup</span><span style='color:#0000e6; '> s" .."</span> <span style='color:#800000; font-weight:bold; '>compare</span> <span style='color:#800000; font-weight:bold; '>not</span>
102:     <span style='color:#e34adc; '>if</span> gotoup <span style='color:#e34adc; '>else</span> gotodown <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( -- )</span> ;
103: 
104: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>name>node</span> <span style='color:#696969; '>( An Ln )</span> norealize <span style='color:#800000; font-weight:bold; '>2drop</span> roothandle <span style='color:#800000; font-weight:bold; '>@</span>  <span style='color:#696969; '>( Node )</span> ;
105: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>get-name-node-prop</span> <span style='color:#696969; '>( Anp Lnp Node -- Ap Lp F | T )</span>
106:     name>node get-package-property <span style='color:#696969; '>( Ap Lp F | T )</span> ;
107: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>set-name-node-prop</span> <span style='color:#696969; '>( Avp Lvp Anp Lnp AnN LnN -- AdrPropRec )</span>
108:     name>node get-package-property <span style='color:#696969; '>( AdrPropRec )</span> ;
109: 
110: <span style='color:#008c00; '>31</span> string namepropgs
111: <span style='color:#008c00; '>31</span> string newvalpropgs
112: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>p$setenv</span> <span style='color:#696969; '>( Av Lv )</span> newvalpropgs st! <span style='color:#696969; '>( -- )</span>
113:     <span style='color:#696969; '>\ space space namepropgs type ." ->" newvalpropgs type</span>
114:     namepropgs /chosen get-package-property
115:     <span style='color:#696969; '>( A L F | T )</span>
116:     <span style='color:#e34adc; '>if</span>  <span style='color:#800000; font-weight:bold; '>cr</span><span style='color:#0000e6; '> ." No defined enviroment!"</span> <span style='color:#696969; '>( -- )</span>
117:     <span style='color:#e34adc; '>else</span> <span style='color:#696969; '>( Aov Lov )</span>
118:         <span style='color:#800000; font-weight:bold; '>2drop</span> newvalpropgs <span style='color:#007997; '>encode-string</span> namepropgs <span style='color:#696969; '>( Av Lv An Ln )</span>
119:         /chosen nodehandle <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#007997; '>property</span> <span style='color:#800000; font-weight:bold; '>r></span> nodehandle <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#696969; '>( -- )</span>
120:     <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( -- )</span> ;
121: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>$setenv</span> <span style='color:#696969; '>( Av Lv An Ln -- )</span> namepropgs st! <span style='color:#696969; '>( -- )</span> <span style='color:#696969; '>( Av Lv )</span> p$setenv <span style='color:#696969; '>( -- )</span> ;
122: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>setenv</span> <span style='color:#696969; '>( -- )</span>
123:     <span style='color:#800000; font-weight:bold; '>bl</span> <span style='color:#800000; font-weight:bold; '>word</span> <span style='color:#800000; font-weight:bold; '>count</span> namepropgs st! <span style='color:#696969; '>( -- )</span>
124:     carret <span style='color:#800000; font-weight:bold; '>word</span> <span style='color:#800000; font-weight:bold; '>count</span> <span style='color:#696969; '>( Av Lv )</span> p$setenv <span style='color:#696969; '>( -- )</span> ;
125: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>$set-default</span> <span style='color:#696969; '>( A L -- )</span> <span style='color:#800000; font-weight:bold; '>2dup</span> namepropgs st!
126:     /options get-package-property <span style='color:#696969; '>( A L F | T )</span>
127:     <span style='color:#e34adc; '>if</span>  <span style='color:#800000; font-weight:bold; '>cr</span><span style='color:#0000e6; '> ." No defined enviroment!"</span> <span style='color:#696969; '>( -- )</span>
128:     <span style='color:#e34adc; '>else</span> <span style='color:#696969; '>( Aov Lov )</span>
129:         <span style='color:#800000; font-weight:bold; '>2drop</span> namepropgs /default get-package-property
130:         <span style='color:#e34adc; '>if</span>    <span style='color:#800000; font-weight:bold; '>cr</span><span style='color:#0000e6; '> ." No defined default value!"</span> <span style='color:#696969; '>( -- )</span>
131:         <span style='color:#e34adc; '>else</span>
132:             <span style='color:#007997; '>decode-string</span> <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#007997; '>encode-string</span> namepropgs
133:             /options nodehandle <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>>r</span> <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#007997; '>property</span> <span style='color:#800000; font-weight:bold; '>r></span> nodehandle <span style='color:#800000; font-weight:bold; '>!</span> <span style='color:#696969; '>( -- )</span>
134:         <span style='color:#e34adc; '>then</span>
135:     <span style='color:#e34adc; '>then</span> <span style='color:#696969; '>( -- )</span> ;
136: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>set-default</span> <span style='color:#696969; '>( -- )</span> <span style='color:#800000; font-weight:bold; '>bl</span> <span style='color:#800000; font-weight:bold; '>word</span> <span style='color:#800000; font-weight:bold; '>count</span> <span style='color:#696969; '>( -- )</span> <span style='color:#696969; '>\ space space 2dup type</span>
137:     $set-default <span style='color:#696969; '>( -- )</span> ;
138: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>set-defaults</span> <span style='color:#696969; '>( -- )</span>
139:     /default <span style='color:#800000; font-weight:bold; '>>code</span> prophandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#696969; '>\ Pointer to the first property name</span>
140:     <span style='color:#e34adc; '>begin</span>
141:         <span style='color:#800000; font-weight:bold; '>>code</span> <span style='color:#800000; font-weight:bold; '>dup</span> ptrnameprop <span style='color:#800000; font-weight:bold; '>count</span> <span style='color:#696969; '>( Phandle A L A L )</span>
142:         <span style='color:#800000; font-weight:bold; '>2dup</span> <span style='color:#800000; font-weight:bold; '>2dup</span> <span style='color:#800000; font-weight:bold; '>cr</span> <span style='color:#800000; font-weight:bold; '>type</span><span style='color:#0000e6; '> s" name"</span> <span style='color:#800000; font-weight:bold; '>compare</span>
143:         <span style='color:#e34adc; '>if</span>   $set-default
144:         <span style='color:#e34adc; '>else</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>2drop</span>
145:         <span style='color:#e34adc; '>then</span>
146:         <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#008c00; '>0</span>=
147:     <span style='color:#e34adc; '>until</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#696969; '>( -- )</span> ;
148: <span style='color:#800000; font-weight:bold; '>: </span><span style='color:#000000; background:#a8a800; '>printenv</span> <span style='color:#696969; '>( -- )</span>
149:     <span style='color:#800000; font-weight:bold; '>cr</span><span style='color:#0000e6; '> ." Variable Name     Value            Default Value"</span> <span style='color:#800000; font-weight:bold; '>cr</span>
150:     /options <span style='color:#800000; font-weight:bold; '>>code</span> prophandle <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#696969; '>( Phandle )</span>
151:     <span style='color:#e34adc; '>begin</span>
152:         <span style='color:#800000; font-weight:bold; '>>code</span> <span style='color:#800000; font-weight:bold; '>dup</span> ptrvalprop <span style='color:#007997; '>@nt</span> <span style='color:#008c00; '>1</span>+
153:         <span style='color:#800000; font-weight:bold; '>over</span> ptrlenvalprop <span style='color:#800000; font-weight:bold; '>@</span>
154:         <span style='color:#008c00; '>2</span> <span style='color:#800000; font-weight:bold; '>pick</span> ptrnameprop <span style='color:#800000; font-weight:bold; '>count</span> <span style='color:#696969; '>( Phandle A L A L )</span>
155:         <span style='color:#800000; font-weight:bold; '>2dup</span><span style='color:#0000e6; '> s" name"</span> <span style='color:#800000; font-weight:bold; '>compare</span>
156:         <span style='color:#e34adc; '>if</span>
157:             <span style='color:#800000; font-weight:bold; '>cr</span> <span style='color:#800000; font-weight:bold; '>2dup</span> <span style='color:#800000; font-weight:bold; '>type</span><span style='color:#0000e6; '> ."    "</span> <span style='color:#800000; font-weight:bold; '>2swap</span> <span style='color:#008c00; '>20</span> space.to.column <span style='color:#800000; font-weight:bold; '>type</span>
158:             /default <span style='color:#696969; '>( A L P )</span> getPhandleProperty <span style='color:#800000; font-weight:bold; '>not</span> <span style='color:#e34adc; '>if</span><span style='color:#0000e6; '> ."     "</span>
159:             <span style='color:#008c00; '>50</span> space.to.column <span style='color:#800000; font-weight:bold; '>type</span> <span style='color:#e34adc; '>then</span>
160:         <span style='color:#e34adc; '>else</span> <span style='color:#800000; font-weight:bold; '>2drop</span> <span style='color:#800000; font-weight:bold; '>2drop</span>
161:         <span style='color:#e34adc; '>then</span>
162:         <span style='color:#800000; font-weight:bold; '>@</span> <span style='color:#800000; font-weight:bold; '>dup</span> <span style='color:#008c00; '>0</span>=
163:     <span style='color:#e34adc; '>until</span> <span style='color:#800000; font-weight:bold; '>drop</span> <span style='color:#696969; '>( -- )</span> <span style='color:#800000; font-weight:bold; '>cr</span> ;
164: 
165: <span style='color:#696969; '>0 [if] \ Only for testing package-to-path</span>
166: <span style='color:#696969; '>120 string mm</span>
167: <span style='color:#696969; '>: tptp ( Phandle ) 120 mm drop rot package-to-path .s mm drop swap type cr (  ) ;</span>
168: <span style='color:#696969; '>[then]</span>
169: <span style='color:#696969; '>\ previous base ! cr</span>
170: 
</pre></body></html>
