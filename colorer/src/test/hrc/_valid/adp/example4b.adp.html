 0:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>HTML</span><span style='color:#a65700; '>></span>
 1:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>HEAD</span><span style='color:#a65700; '>></span>
 2: <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>TITLE</span><span style='color:#a65700; '>></span>Subscription Processed Successfully<span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>TITLE</span><span style='color:#a65700; '>></span>
 3:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>HEAD</span><span style='color:#a65700; '>></span>
 4:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>BODY</span><span style='color:#274796; '> </span><span style='color:#074726; '>BGCOLOR</span><span style='color:#808030; '>=</span><span style='color:#0000e6; '>"#ffffff"</span><span style='color:#a65700; '>></span>
 5:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>H2</span><span style='color:#a65700; '>></span>
 6: Online Newsletter Subscription
 7:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>H2</span><span style='color:#a65700; '>></span>
 8:  <span style='color:#a65700; '>&lt;</span><span style='color:#800000; font-weight:bold; '>P</span><span style='color:#a65700; '>></span>
 9:  Thank You for subscribing to our newsletter!
10:  <span style='color:#5f5035; background:#ffffe8; '>&lt;%</span><span style='color:#000000; background:#ffffe8; '></span>
11: <span style='color:#696969; background:#ffffe8; '> # Get form data and assign to variables</span><span style='color:#000000; background:#ffffe8; '></span>
12: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> r</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_conn form </span><span style='color:#000000; background:#ffffe8; '>$conn</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
13: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> name</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set get </span><span style='color:#000000; background:#ffffe8; '>$r</span><span style='color:#000000; background:#ffffe8; '> name</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
14: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> title</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set get </span><span style='color:#000000; background:#ffffe8; '>$r</span><span style='color:#000000; background:#ffffe8; '> title</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
15: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> notify</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set get </span><span style='color:#000000; background:#ffffe8; '>$r</span><span style='color:#000000; background:#ffffe8; '> notify</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
16: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> sendemail</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set get </span><span style='color:#000000; background:#ffffe8; '>$r</span><span style='color:#000000; background:#ffffe8; '> sendemail</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
17: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> emailaddr</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_set get </span><span style='color:#000000; background:#ffffe8; '>$r</span><span style='color:#000000; background:#ffffe8; '> emailaddr</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
18: <span style='color:#000000; background:#ffffe8; '></span>
19: <span style='color:#696969; background:#ffffe8; '> # Set subscription options explicity to 0 if not checked</span><span style='color:#000000; background:#ffffe8; '></span>
20: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>if</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '>$notify</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>!</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>1</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> notify</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>0</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '></span>
21: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>if</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '>$sendemail</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>!</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>1</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> sendemail</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>0</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '></span>
22: <span style='color:#000000; background:#ffffe8; '></span>
23: <span style='color:#696969; background:#ffffe8; '> # Update database with new subscription</span><span style='color:#000000; background:#ffffe8; '></span>
24: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> db</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#000000; background:#ffffe8; '>ns_db gethandle</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#000000; background:#ffffe8; '></span>
25: <span style='color:#000000; background:#ffffe8; '> ns_db dml </span><span style='color:#000000; background:#ffffe8; '>$db</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>\</span><span style='color:#000000; background:#ffffe8; '></span>
26: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"insert into test values (</span><span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#0000e6; background:#ffffe8; '>ns_dbquotevalue </span><span style='color:#0000e6; background:#ffffe8; '>$name</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#0000e6; background:#ffffe8; '>,</span>
27: <span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#0000e6; background:#ffffe8; '>ns_dbquotevalue </span><span style='color:#0000e6; background:#ffffe8; '>$title</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#0000e6; background:#ffffe8; '>, </span><span style='color:#0000e6; background:#ffffe8; '>$notify</span><span style='color:#0000e6; background:#ffffe8; '>, </span><span style='color:#0000e6; background:#ffffe8; '>$sendemail</span><span style='color:#0000e6; background:#ffffe8; '>,</span>
28: <span style='color:#800080; background:#ffffe8; '>[</span><span style='color:#0000e6; background:#ffffe8; '>ns_dbquotevalue </span><span style='color:#0000e6; background:#ffffe8; '>$emailaddr</span><span style='color:#800080; background:#ffffe8; '>]</span><span style='color:#0000e6; background:#ffffe8; '>)"</span><span style='color:#000000; background:#ffffe8; '></span>
29: <span style='color:#000000; background:#ffffe8; '></span>
30: <span style='color:#696969; background:#ffffe8; '> # Send email message to subscription administrator</span><span style='color:#000000; background:#ffffe8; '></span>
31: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> body</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"A new newsletter subscription was added for "</span><span style='color:#000000; background:#ffffe8; '></span>
32: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>append</span><span style='color:#000000; background:#ffffe8; '> body</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$name</span><span style='color:#000000; background:#ffffe8; '></span>
33: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>append</span><span style='color:#000000; background:#ffffe8; '> body</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>". The database has been updated."</span><span style='color:#000000; background:#ffffe8; '></span>
34: <span style='color:#000000; background:#ffffe8; '> ns_sendmail </span><span style='color:#0000e6; background:#ffffe8; '>"subscript@thecompany.com"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"dbadmin@thecompany.com"</span><span style='color:#000000; background:#ffffe8; '></span>
35: <span style='color:#808030; background:#ffffe8; '>\</span><span style='color:#000000; background:#ffffe8; '></span>
36: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"New Subscription"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$body</span><span style='color:#000000; background:#ffffe8; '></span>
37: <span style='color:#000000; background:#ffffe8; '></span>
38: <span style='color:#696969; background:#ffffe8; '> # Send email message to user</span><span style='color:#000000; background:#ffffe8; '></span>
39: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>set</span><span style='color:#000000; background:#ffffe8; '> body</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"Your online newsletter subscription has been successfully</span>
40: <span style='color:#0000e6; background:#ffffe8; '>processed."</span><span style='color:#000000; background:#ffffe8; '></span>
41: <span style='color:#000000; background:#ffffe8; '> ns_sendmail </span><span style='color:#000000; background:#ffffe8; '>$emailaddr</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"dbadmin@thecompany.com"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>\</span><span style='color:#000000; background:#ffffe8; '></span>
42: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"Your Online Subscription"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$body</span><span style='color:#000000; background:#ffffe8; '></span>
43: <span style='color:#000000; background:#ffffe8; '></span>
44: <span style='color:#696969; background:#ffffe8; '> # Show type of subscription to user</span><span style='color:#000000; background:#ffffe8; '></span>
45: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>if</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '>$notify</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>1</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '></span>
46: <span style='color:#000000; background:#ffffe8; '>ns_puts </span><span style='color:#0000e6; background:#ffffe8; '>"You will be notified via email when the online newsletter</span>
47: <span style='color:#0000e6; background:#ffffe8; '>changes."</span><span style='color:#000000; background:#ffffe8; '></span>
48: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '></span>
49: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; font-weight:bold; '>if</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '>$sendemail</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#008c00; background:#ffffe8; '>1</span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>{</span><span style='color:#000000; background:#ffffe8; '></span>
50: <span style='color:#000000; background:#ffffe8; '>ns_puts </span><span style='color:#0000e6; background:#ffffe8; '>"Future issues of the newsletter will be sent to you</span>
51: <span style='color:#0000e6; background:#ffffe8; '>via email."</span><span style='color:#000000; background:#ffffe8; '></span>
52: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#800080; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '></span>
53: <span style='color:#000000; background:#ffffe8; '> </span><span style='color:#5f5035; background:#ffffe8; '>%></span>
54:  <span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>BODY</span><span style='color:#a65700; '>></span><span style='color:#a65700; '>&lt;/</span><span style='color:#800000; font-weight:bold; '>HTML</span><span style='color:#a65700; '>></span>
55: 
