#revision 1216
	ctapmex 10.01.2010 19:39
	1. мы не обязаны обрабатывать ошибки пользователя - если он залез в реестр или в какой то файл и что то напортачил, 
		то надо говорить ему об этом и все. Trim будем применять только при сохранении настроек из диалога.
	2. функция rGetValueSz для чтения реестра - сама выделяет нужное количество памяти под строку.
	3. Переделал диалог настройки. Раньше могли происходить утечки памяти на стороне фара, из-за того что мы не освобождали
		хэндл открытого окна.
		 Кнопка "Reload Base" теперь служит для проверки базы и цветовой схемы, указанной в диалоге настройки, а не читая значения из реестра.
	4. поправлена ошибка обработки пользовательского пути до catalog.xml, приводящая к полному игнорированию этого пути
		
		!!!надо внимательно протестировать работу меню настройки!!!

#revision 1201
	ctapmex 06.01.2010 23:41
	1. команда clr не работала если имя файла передавалось в кавычках
	!!!на ближайшее будущее, пересмотреть OpenPluginW свежим взглядом - слишком много операций над строками!!!

#revision 1197
	ctapmex 05.01.2010 23:47
	1. если плагин отключен, то зачем производить кучу ненужных действий при старте редактора? исправлено
	2. мелкие оптимизации
	3. добавлен модуль vld.h в дебаг версию. Visual Leak Detector http://sites.google.com/site/dmoulding/vld
		можно удалить, если нету его.

#revision 1195
	ctapmex 05.01.2010 21:24
	1. мелкие оптимизации

#revision 1194
	ctapmex 05.01.2010 20:11
	1. мелкие оптимизации и убирание ненужного

#revision 1189
	ctapmex 04.01.2010 16:41
	1. поправил схему c.hrc для нормального отображения переменных окружения
	2. слияние с r1180

#revision 1188
	ctapmex 03.01.2010
	1. продолжение r1187, не учитывался вариант с относительным длинным путем. Написан более изящный вариант
		с использsванием API Far 
	2. отказ от build_message
		Не удобно, когда разбивается путь к файлу на строки (нельзя скопировать). Да и стало известно, что в фаре 
		можно курсором перейти на длинную строку и просмотреть её полностью. Надежда на то, что в будущих версиях
		фара будет интуитивно понятно, что данная строка в сообщении об ошибке длинная, и её можно прокрутить
	3. в сообщения об ошибках info->Message добавил флаг FMSG_WARNING

#revision 1187
	ctapmex 30.12.2009 15:45
	1. команда clr: поддерживает длинные пути windows (более 260 символов), и переменные окружения
		
#revision 1186
	ctapmex 30.12.2009 11:51
	1. убрал один warning
	2. в пути до catalog.xml можно указывать переменные окружения. Например %programfiles%\far2\plugins\colorer_se\catalog.xml

#revision 1185
	ctapmex 30.12.2009 10:51
	1. вывод ошибки в viewfile сделал через функцию build_message, чтобы было полностью видно имя файла
	2. поправлены файлы помощи для pcolorer2 для отражения r1183

	Поддержка pcolorer будет проходить на остаточном принципе. Если будет время и желание.

#revision 1184
	ctapmex 30.12.2009 09:56
	1. в TextConsoleViewer::view  в вызове CreateConsoleScreenBuffer установил разрешение на чтение/запись. Иначе 
		приводит к "зависанию" некоторых программ. "При использовании команды clr:!.! для просмотра файлов far "зависает". В ConEmu." (C)Maximus5

#revision 1183
	ctapmex 30.12.2009 09:48
	1. в ParserFactory.SearchPath поиск catalog.xml шёл не в том порядке, как написанно в хелпе для pcolorer2.
		Так же не учитывалось, что HOMEPATH в Windows не содержит имя диска
		установим такой порядок поиска
		для Windows 
		- %COLORER5CATALOG%
		- %HOMEDRIVE%%HOMEPATH%\.colorer5catalog
		- %SYSTEMROOT%/.colorer5catalog (или %WINDIR% в w9x)
		- Каталог с dll плагина, на уровень выше, на два уровня выше.
		для nix 
		- %COLORER5CATALOG%
		- %HOME%\.colorer5catalog
		- /usr/share/colorer/catalog.xml
		- /usr/local/share/colorer/catalog.xml		

#revision 1182 
  ctapmex 29.12.2009 16:06
	1. повторяю слова t-rex, реально запарило.
	"Все изменения в коде только косметические. Тупо надоела уже мешанина табов и пробелов и т.п.
   Прогрнал на сорцы следующее:
   AStyle --style=ansi --indent=tab=4 --brackets=break --indent-classes --indent-switches --indent-namespaces --indent-preprocessor --break-blocks --delete-empty-lines --unpad-paren --keep-one-line-statements --keep-one-line-blocks
   Не идеально конечно, но уже намного приятней.
  
   Так что не забываем, в коде нужно использовать табы. Таб == 4 пробела."

	Изменения касаются только pcolorer2

#revision 1181 
  ctapmex 29.12.2009 15:51
	1. функция build_message для построения сообщения об ошибке. Разбивает длинную строку (длиннее ширины консоли).
			на более мелкие.
	2. для ошибки открытия файла добавлено имя этого файла.

#revision 1179 
  ctapmex 24.12.2009 16:25
	1. для r1169 пункт 3 забыл мелочь одну

#revision 1178 
  ctapmex 23.12.2009 23:44
	1. очередная правка файлов помощи для плагинов фара
	2. устанавливаем версию плагинов в 1.0.2.1 и собираем релиз
	3. сборка схем. тесты проходят на 100%

#revision 1177 
  ctapmex 23.12.2009 17:34
	1. слил с ревизией 1174.
	2. отредактированы файлы помощи для плагинов фара 
	3. поправлен список изменений в схемах
	С пунктом 1 возможно и бегу в переди паровоза, но думаю на большем количестве людей оно быстрее оттестируется.
	Планирую в течении суток сделать релиз с полным набором - плагин + схемы

#revision 1176 
  ctapmex 23.12.2009 12:10
	1. отредактированы языковые файлы и файлы помощи для плагинов фара

#revision 1175 
  ctapmex 23.12.2009 11:45
  1. в pcolorer внесены примерно теже изменения, что и в pcolorer2 в этом бранче
		- исправлены утечки памяти
		- плагин убирает за собой при отключении
		- ошибки при работе с не trim строками
	2. в pcolorer2 исправлена небольшая ошибка при работе с не trim строками

#revision 1173 
  ctapmex 22.12.2009 22:06
  1. для pcolorer создан проект в VC 2008
	2. исправлены файлы для нормальной сборки под vc, соответсвенно поправлены и makefile

#revision 1172 
  ctapmex 22.12.2009 21:20
  1. исправлены файлы помощи и языковые файлы плагина pcolorer

#revision 1171
  ctapmex 22.12.2009 21:08
	1. исправлен makefile.vc для pcolorer.
	2. обновлен farsdk
	3. плагин pcolorer приведен к состоянию собирается/работает

#revision 1170
  ctapmex 22.12.2009 20:09
	1. исправлен makefile.vc для pcolorer2. таргет clean работал не правильно, не мог вызвать rmdir
	2. из shared/_dependencies.dep удалены ненужные упоминания файлов плагина для фара

#revision 1169
  ctapmex 18.12.2009 21:33
  1. colorer\hrc\auto\far.hrc переименован в colorer\hrc\auto\fartypes.hrc - часто создается путаница
		с lib/far.hrc
  2. в far.hrc исправлена ошибка с неверным путем до схемы раскраски макросов (r1150)
	3. для "Config, INI and CTL" убран вес маски типов файлов. иначе схема не вызывается никогда. отличительной
		чертой от "Other INI" - начальный символ #

#revision 1168
  ctapmex 18.12.2009 21:07
  1. немного поправлен reg.hrc , для красоты и приемственности старой раскраски
  2. для вызова схемы "Far macros" добавлены актуальные шаблоны имени файлов

#revision 1167
  ctapmex 18.12.2009 15:45
	1. переработана схема reg.hrc
		 в ревизиях 1159-1161 был переделан reg.hrc, переписан с нуля. После написаниея  выяснялось, 
			что существует два подхода к написанию схем. Жадный и не жадный. я писал его по жадному алгоритму.
	  - обычный (не жадный), который применяется во всех схемах. идя слева на право с текста беря ближайший 
				нужный элемент (скобка, кавычка). При таком подходе часты ситуации , когда из-за одной ошибки все 
				ниже идущее раскрашивается как ошибка
		- жадный. мы пытаемся в частично неверной строке найти верные части и указать ошибки. Для рег файла в 
			итоге получилось неплохо. Но не идеально.. ограничения моих способностей и самой библиотеки, а скорее 
			всего и самого подхода
		 жадный - более красивое отображение при ошибках, но есть случаи которые не сделать никак. Например 
		 	двойственное понимание строки	"name"="string" ;dfsd" . тут может быть ;dfsd" комментарием, а может 
		 	быть частью значения с ошибкой , где средняя кавычка не экранирована
		 не жадный - отображается на корректных файлах нормально, но на ошибках может раскрасить неверно весь файл
		
		лучше корректность на корректных файлах чем красота на некорректных
		ревизии 1159-1161 интересны как попытка применения другого подхода. Так сказать академический интерес

#revision 1166
  ctapmex 18.12.2009 10:09
	1. в c.hrc добавлено корректное отображение переменных окружения  %PATH%

#revision 1165
  ctapmex 17.12.2009 20:01
	1. удалил test.reg из тестов, т.к. он заменен в ревизии 1159 на более объемный тест
	2. поправлен config.hrc . Комментарии должны быть или с начала строки , или миниму через 
		пробельный символ от последнего текста. пример qwqwq=qwqwqw#sdsds   , тут # значение параметра
	3. исправлен valid файл для config.hrc , ruby.rb , build.xml, forth (внешне все нормально)
  4. исправлена раскраска awk.hrc ,теперь проходит тест

#revision 1164
  ctapmex 17.12.2009 15:12
	1. правка shortcuts.reg для работы с far2

#revision 1163
  ctapmex 17.12.2009 12:25
	1. слияние ревизий 1029-1068,1071-1078,1080-1099,1105-1107,1110 из бранча EFREMOV-BASE2

#revision 1162
  ctapmex 15.12.2009 11:44
	1. исправление в русском языковом файле плагина для far

--------------------
 в ревизиях 1159-1161 был переделан reg.hrc
 работает теперь по жадному алгоритму, т.е. пытается даже в ошибочной строке найти "хорошую строку" 
  и указать на ошибки в ней. Благодаря чему стала хорошо работать подсветка экранируемых символов, 
  и деление на имя параметра и значение параметра . Так же теперь при ошибках в одной строке не светятся 
  ошибочными нижележащие.
 Далее, убрана подсветка переменных ( %чтото% и $чтото ) в именах параметров. оно надо ?
 Строковое значение параметра (в кавычках) должно быть в одной строке , иначе подсвечивается как ошибка.
 подсветка unc путей.
 и другие мелочи
 но есть 2 бага: 
 	1. если в имени параметра встречается "= (даже с пробелами между ними) строка делится на части не правильно.
	 экранирование кавычки не поможет.
 	2. например такой случай 
 		 @="" ;"
 		 когда в комментарии идет кавычка, даже экранированная. жадный алгоритм считает что тут нет комментария.
-------------------

#revision 1161
  ctapmex 14.12.2009 17:42
	1. в схеме reg.hrc в подгруппе far не обрабатывались щначения по умолчанию @

#revision 1160
  ctapmex 14.12.2009 17:03
	1. в схеме reg.hrc поправлено отображение UNC путей

#revision 1159
  ctapmex 14.12.2009 16:48
	1. переработана схема reg.hrc
		разобраны все возможные случаи, кроме одного - последний символ в файле должен быть \r\n. Как это 
			сделать, и возможно ли не знаю.
		ошибки связанные с макросами фара не правились, это отдельная схема.


#revision 1158 
  ctapmex 04.12.2009 12:40
	1. правки языковых файлов плагина
	2. установка номера версии плагина в 1.0.2

#revision 1157 
  ctapmex 04.12.2009 11:44
	1. изменено значение опции "Крест".
	 [ ] Не показывать никогда
     [?] Показывать если включено в схеме
     [x] Показывать всегда
     исправлено имя ключа в реестре, для отражения сути 
    2. исправлены файлы помощи и языковые файлы плагина

#revision 1156 
  ctapmex 03.12.2009 17:02
	1. взяты изменения транка ревизии 1146, но сделано немного по другому - зачем выделять
	   память под класс, если на следующем шаге она уже освобождается